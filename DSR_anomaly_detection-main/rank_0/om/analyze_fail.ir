# ===============================================================================================
# The following shows the last analyze fail log message.
# ===============================================================================================

----------------------------------------------------
- Caught exception:
----------------------------------------------------
In the inputs of operation 'setitem', there are unsupported syntax in graph mode. Those codes would be fallen back to python interpreter, which is not supported for operation 'setitem'.

----------------------------------------------------
- C++ Call Stack: (For framework developers)
----------------------------------------------------
mindspore/ccsrc/frontend/operator/composite/multitype_funcgraph.cc:194 PrintMatchFailLog

----------------------------------------------------
- The Traceback of Net Construct Code:
----------------------------------------------------
# 0 In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77
        for i in range(encoding_indices.shape[1]):
        ^
# 1 In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:78
            encodings[i, encoding_indices[i]] = 1
            ^

# ===============================================================================================
# The following shows the IR when the function graphs evaluation fails to help locate the problem.
# You can search the last ------------------------> to the node which is evaluated failure.
# Refer to https://www.mindspore.cn/search?inputValue=analyze_fail.ir to get more instructions.
# ===============================================================================================

# IR entry: @discrete_model_VectorQuantizerEMA_construct_13
# Total subgraphs: 114

# Total params: 1
# Params:
%para1_inputs : <null>

subgraph attr:
subgraph instance: discrete_model_VectorQuantizerEMA_construct_13 : 0x707c5540
# In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:60/    def construct(self, inputs):/
subgraph @discrete_model_VectorQuantizerEMA_construct_13(%para1_inputs) {
  %1(CNode_83) = getattr(%para1_inputs, "permute")
      : (<Tensor[Float32], (8, 128, 32, 32)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %2(CNode_84) = %1(I64(0), I64(2), I64(3), I64(1))
      : (<Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>) -> (<Tensor[Float32], (8, 32, 32, 128)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %3(CNode_85) = getattr(%2, "contiguous")
      : (<Tensor[Float32], (8, 32, 32, 128)>, <String, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %4(inputs) = %3()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %5(CNode_86) = getattr(%4, "view")
      : (<Any(Tensor)[Float32], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %6(CNode_87) = S_Prim_negative(I64(1))
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %7(flat_input) = %5(%6, I64(128))
      : (<Int64, NoShape>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %8(CNode_88) = S_Prim_pow(%7, I64(2))
      : (<Any(Tensor)[Float32], (-2)>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %9(CNode_89) = S_Prim_MakeTuple(%8)
      : (<Any(Tensor)[Float32], (-2)>) -> (<Tuple[Any(Tensor)[Float32]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %10(CNode_90) = S_Prim_MakeTuple("dim", "keepdim")
      : (<String, NoShape>, <String, NoShape>) -> (<Tuple[String*2], TupleShape(NoShape, NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %11(CNode_91) = S_Prim_MakeTuple(I64(1), Bool(1))
      : (<Int64, NoShape>, <Bool, NoShape>) -> (<Tuple[Int64,Bool], TupleShape(NoShape, NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %12(CNode_92) = S_Prim_make_dict(%10, %11)
      : (<Tuple[String*2], TupleShape(NoShape, NoShape)>, <Tuple[Int64,Bool], TupleShape(NoShape, NoShape)>) -> (<Dictionary[[dim,keepdim,],[Int64,Bool]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %13(CNode_93) = UnpackCall_unpack_call(@sum_94, %9, %12)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float32]], TupleShape((-2))>, <Dictionary[[dim,keepdim,],[Int64,Bool]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %14(CNode_95) = S_Prim_pow(Tensor(shape=[4096, 128], dtype=Float32, value=[...]), I64(2))
      : (<Tensor[Float32], (4096, 128)>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %15(CNode_96) = S_Prim_MakeTuple(%14)
      : (<Any(Tensor)[Float32], (-2)>) -> (<Tuple[Any(Tensor)[Float32]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %16(CNode_97) = S_Prim_MakeTuple("dim")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %17(CNode_98) = S_Prim_MakeTuple(I64(1))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %18(CNode_99) = S_Prim_make_dict(%16, %17)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[dim,],[Int64]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %19(CNode_100) = UnpackCall_unpack_call(@sum_94, %15, %18)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float32]], TupleShape((-2))>, <Dictionary[[dim,],[Int64]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %20(CNode_101) = S_Prim_add(%13, %19)
      : (<Any(Tensor)[Float64], (-2)>, <Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %21(CNode_102) = getattr(Tensor(shape=[4096, 128], dtype=Float32, value=[...]), "t")
      : (<Tensor[Float32], (4096, 128)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %22(CNode_103) = %21()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %23(CNode_105) = call @matmul_104(%7, %22)
      : (<Any(Tensor)[Float32], (-2)>, <Tensor[Float32], (128, 4096)>) -> (<Negligible(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %24(CNode_106) = S_Prim_mul(I64(2), %23)
      : (<Int64, NoShape>, <Negligible(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %25(distances) = S_Prim_sub(%20, %24)
      : (<Any(Tensor)[Float64], (-2)>, <Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %26(CNode_107) = S_Prim_MakeTuple(%25)
      : (<Any(Tensor)[Float64], (-2)>) -> (<Tuple[Any(Tensor)[Float64]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %27(CNode_108) = S_Prim_MakeTuple("axis")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %28(CNode_109) = S_Prim_MakeTuple(I64(1))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %29(CNode_110) = S_Prim_make_dict(%27, %28)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[axis,],[Int64]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %30(CNode_111) = UnpackCall_unpack_call(@argmin_112, %26, %29)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float64]], TupleShape((-2))>, <Dictionary[[axis,],[Int64]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %31(CNode_113) = getattr(%30, "unsqueeze")
      : (<Any(Tensor)[Float64], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %32(encoding_indices) = %31(I64(1))
      : (<Int64, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %33(CNode_114) = getattr(%32, "shape")
      : (<Any(Tensor)[Float64], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:75/        encodings = ops.zeros((encoding_indices.shape[0], self._num_embeddings))    #.to(inputs.device)  # question/
  %34(CNode_115) = S_Prim_getitem(%33, I64(0))
      : (<Any(Tensor)[Float64], (-2)>, <Int64, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:75/        encodings = ops.zeros((encoding_indices.shape[0], self._num_embeddings))    #.to(inputs.device)  # question/
  %35(CNode_116) = S_Prim_MakeTuple(%34, I64(4096))
      : (<Any(Tensor)[Float64], (-2)>, <Int64, NoShape>) -> (<Tuple[Any(Tensor)[Float64],Int64], TupleShape((-2), NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:75/        encodings = ops.zeros((encoding_indices.shape[0], self._num_embeddings))    #.to(inputs.device)  # question/
  %36(encodings) = call @zeros_117(%35)
      : (<Tuple[Any(Tensor)[Float64],Int64], TupleShape((-2), NoShape)>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:75/        encodings = ops.zeros((encoding_indices.shape[0], self._num_embeddings))    #.to(inputs.device)  # question/

#------------------------> 0
  %37(CNode_118) = call @↵discrete_model_VectorQuantizerEMA_construct_81(I64(0), %36)
      : (<Int64, NoShape>, <Any(Tensor)[Float32], (-2)>) -> (<null>)
      #scope: (Default)
  Return(%37)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
}
# Order:
#   1: @discrete_model_VectorQuantizerEMA_construct_13:CNode_83{[0]: ValueNode<Primitive> getattr, [1]: param_inputs, [2]: ValueNode<StringImm> permute}
#   2: @discrete_model_VectorQuantizerEMA_construct_13:CNode_84{[0]: CNode_83, [1]: ValueNode<Int64Imm> 0, [2]: ValueNode<Int64Imm> 2, [3]: ValueNode<Int64Imm> 3, [4]: ValueNode<Int64Imm> 1}
#   3: @discrete_model_VectorQuantizerEMA_construct_13:CNode_85{[0]: ValueNode<Primitive> getattr, [1]: CNode_84, [2]: ValueNode<StringImm> contiguous}
#   4: @discrete_model_VectorQuantizerEMA_construct_13:inputs{[0]: CNode_85}
#   5: @discrete_model_VectorQuantizerEMA_construct_13:input_shape{[0]: ValueNode<Primitive> getattr, [1]: inputs, [2]: ValueNode<StringImm> shape}
#   6: @discrete_model_VectorQuantizerEMA_construct_13:CNode_86{[0]: ValueNode<Primitive> getattr, [1]: inputs, [2]: ValueNode<StringImm> view}
#   7: @discrete_model_VectorQuantizerEMA_construct_13:CNode_87{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 1}
#   8: @discrete_model_VectorQuantizerEMA_construct_13:flat_input{[0]: CNode_86, [1]: CNode_87, [2]: ValueNode<Int64Imm> 128}
#   9: @discrete_model_VectorQuantizerEMA_construct_13:CNode_88{[0]: ValueNode<DoSignaturePrimitive> S_Prim_pow, [1]: flat_input, [2]: ValueNode<Int64Imm> 2}
#  10: @discrete_model_VectorQuantizerEMA_construct_13:CNode_89{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_88}
#  11: @discrete_model_VectorQuantizerEMA_construct_13:CNode_90{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> dim, [2]: ValueNode<StringImm> keepdim}
#  12: @discrete_model_VectorQuantizerEMA_construct_13:CNode_91{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Int64Imm> 1, [2]: ValueNode<BoolImm> true}
#  13: @discrete_model_VectorQuantizerEMA_construct_13:CNode_92{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_90, [2]: CNode_91}
#  14: @discrete_model_VectorQuantizerEMA_construct_13:CNode_93{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.119, [1]: ValueNode<FuncGraph> sum_94, [2]: CNode_89, [3]: CNode_92}
#  15: @discrete_model_VectorQuantizerEMA_construct_13:CNode_95{[0]: ValueNode<DoSignaturePrimitive> S_Prim_pow, [1]: ValueNode<Tensor> Tensor(shape=[4096, 128], dtype=Float32, value=[...]), [2]: ValueNode<Int64Imm> 2}
#  16: @discrete_model_VectorQuantizerEMA_construct_13:CNode_96{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_95}
#  17: @discrete_model_VectorQuantizerEMA_construct_13:CNode_97{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> dim}
#  18: @discrete_model_VectorQuantizerEMA_construct_13:CNode_98{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Int64Imm> 1}
#  19: @discrete_model_VectorQuantizerEMA_construct_13:CNode_99{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_97, [2]: CNode_98}
#  20: @discrete_model_VectorQuantizerEMA_construct_13:CNode_100{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.120, [1]: ValueNode<FuncGraph> sum_94, [2]: CNode_96, [3]: CNode_99}
#  21: @discrete_model_VectorQuantizerEMA_construct_13:CNode_101{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: CNode_93, [2]: CNode_100}
#  22: @discrete_model_VectorQuantizerEMA_construct_13:CNode_102{[0]: ValueNode<Primitive> getattr, [1]: ValueNode<Tensor> Tensor(shape=[4096, 128], dtype=Float32, value=[...]), [2]: ValueNode<StringImm> t}
#  23: @discrete_model_VectorQuantizerEMA_construct_13:CNode_103{[0]: CNode_102}
#  24: @discrete_model_VectorQuantizerEMA_construct_13:CNode_105{[0]: ValueNode<FuncGraph> matmul_104, [1]: flat_input, [2]: CNode_103}
#  25: @discrete_model_VectorQuantizerEMA_construct_13:CNode_106{[0]: ValueNode<DoSignaturePrimitive> S_Prim_mul, [1]: ValueNode<Int64Imm> 2, [2]: CNode_105}
#  26: @discrete_model_VectorQuantizerEMA_construct_13:distances{[0]: ValueNode<DoSignaturePrimitive> S_Prim_sub, [1]: CNode_101, [2]: CNode_106}
#  27: @discrete_model_VectorQuantizerEMA_construct_13:CNode_107{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: distances}
#  28: @discrete_model_VectorQuantizerEMA_construct_13:CNode_108{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> axis}
#  29: @discrete_model_VectorQuantizerEMA_construct_13:CNode_109{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Int64Imm> 1}
#  30: @discrete_model_VectorQuantizerEMA_construct_13:CNode_110{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_108, [2]: CNode_109}
#  31: @discrete_model_VectorQuantizerEMA_construct_13:CNode_111{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.121, [1]: ValueNode<FuncGraph> argmin_112, [2]: CNode_107, [3]: CNode_110}
#  32: @discrete_model_VectorQuantizerEMA_construct_13:CNode_113{[0]: ValueNode<Primitive> getattr, [1]: CNode_111, [2]: ValueNode<StringImm> unsqueeze}
#  33: @discrete_model_VectorQuantizerEMA_construct_13:encoding_indices{[0]: CNode_113, [1]: ValueNode<Int64Imm> 1}
#  34: @discrete_model_VectorQuantizerEMA_construct_13:CNode_114{[0]: ValueNode<Primitive> getattr, [1]: encoding_indices, [2]: ValueNode<StringImm> shape}
#  35: @discrete_model_VectorQuantizerEMA_construct_13:CNode_115{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_114, [2]: ValueNode<Int64Imm> 0}
#  36: @discrete_model_VectorQuantizerEMA_construct_13:CNode_116{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_115, [2]: ValueNode<Int64Imm> 4096}
#  37: @discrete_model_VectorQuantizerEMA_construct_13:encodings{[0]: ValueNode<FuncGraph> zeros_117, [1]: CNode_116}
#  38: @discrete_model_VectorQuantizerEMA_construct_13:CNode_122{[0]: ValueNode<Primitive> getattr, [1]: encoding_indices, [2]: ValueNode<StringImm> shape}
#  39: @discrete_model_VectorQuantizerEMA_construct_13:CNode_123{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_122, [2]: ValueNode<Int64Imm> 1}
#  40: @discrete_model_VectorQuantizerEMA_construct_13:CNode_124{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_range, [1]: CNode_123}
#  41: @discrete_model_VectorQuantizerEMA_construct_13:CNode_125{[0]: ValueNode<DoSignaturePrimitive> S_Prim_inner_len, [1]: CNode_124}
#  42: @discrete_model_VectorQuantizerEMA_construct_13:CNode_126{[0]: ValueNode<Primitive> Return, [1]: CNode_118}
#  43: @discrete_model_VectorQuantizerEMA_construct_13:CNode_118{[0]: ValueNode<FuncGraph> ↵discrete_model_VectorQuantizerEMA_construct_81, [1]: ValueNode<Int64Imm> 0, [2]: encodings}
#  44: @discrete_model_VectorQuantizerEMA_construct_13:CNode_127{[0]: ValueNode<Primitive> MakeTuple, [1]: ValueNode<StringImm> __py_exec_index1_len__}
#  45: @discrete_model_VectorQuantizerEMA_construct_13:CNode_128{[0]: ValueNode<Primitive> MakeTuple, [1]: CNode_124}


subgraph attr:
subgraph instance: ↵discrete_model_VectorQuantizerEMA_construct_81 : 0x6fa8eb60
# In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:60/    def construct(self, inputs):/
subgraph @↵discrete_model_VectorQuantizerEMA_construct_81 parent: [subgraph @discrete_model_VectorQuantizerEMA_construct_13](%para2_, %para3_) {
  %1(CNode_83) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%para1_inputs, "permute")
      : (<Tensor[Float32], (8, 128, 32, 32)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %2(CNode_84) = $(discrete_model_VectorQuantizerEMA_construct_13):%1(I64(0), I64(2), I64(3), I64(1))
      : (<Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>) -> (<Tensor[Float32], (8, 32, 32, 128)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %3(CNode_85) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%2, "contiguous")
      : (<Tensor[Float32], (8, 32, 32, 128)>, <String, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %4(inputs) = $(discrete_model_VectorQuantizerEMA_construct_13):%3()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %5(CNode_86) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%4, "view")
      : (<Any(Tensor)[Float32], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %6(CNode_87) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_negative(I64(1))
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %7(flat_input) = $(discrete_model_VectorQuantizerEMA_construct_13):%5(%6, I64(128))
      : (<Int64, NoShape>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %8(CNode_88) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_pow(%7, I64(2))
      : (<Any(Tensor)[Float32], (-2)>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %9(CNode_89) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(%8)
      : (<Any(Tensor)[Float32], (-2)>) -> (<Tuple[Any(Tensor)[Float32]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %10(CNode_90) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple("dim", "keepdim")
      : (<String, NoShape>, <String, NoShape>) -> (<Tuple[String*2], TupleShape(NoShape, NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %11(CNode_91) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(I64(1), Bool(1))
      : (<Int64, NoShape>, <Bool, NoShape>) -> (<Tuple[Int64,Bool], TupleShape(NoShape, NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %12(CNode_92) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_make_dict(%10, %11)
      : (<Tuple[String*2], TupleShape(NoShape, NoShape)>, <Tuple[Int64,Bool], TupleShape(NoShape, NoShape)>) -> (<Dictionary[[dim,keepdim,],[Int64,Bool]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %13(CNode_93) = $(discrete_model_VectorQuantizerEMA_construct_13):UnpackCall_unpack_call(@sum_94, %9, %12)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float32]], TupleShape((-2))>, <Dictionary[[dim,keepdim,],[Int64,Bool]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %14(CNode_95) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_pow(Tensor(shape=[4096, 128], dtype=Float32, value=[...]), I64(2))
      : (<Tensor[Float32], (4096, 128)>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %15(CNode_96) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(%14)
      : (<Any(Tensor)[Float32], (-2)>) -> (<Tuple[Any(Tensor)[Float32]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %16(CNode_97) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple("dim")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %17(CNode_98) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(I64(1))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %18(CNode_99) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_make_dict(%16, %17)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[dim,],[Int64]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %19(CNode_100) = $(discrete_model_VectorQuantizerEMA_construct_13):UnpackCall_unpack_call(@sum_94, %15, %18)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float32]], TupleShape((-2))>, <Dictionary[[dim,],[Int64]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %20(CNode_101) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_add(%13, %19)
      : (<Any(Tensor)[Float64], (-2)>, <Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %21(CNode_102) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(Tensor(shape=[4096, 128], dtype=Float32, value=[...]), "t")
      : (<Tensor[Float32], (4096, 128)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %22(CNode_103) = $(discrete_model_VectorQuantizerEMA_construct_13):%21()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %23(CNode_105) = $(discrete_model_VectorQuantizerEMA_construct_13):call @matmul_104(%7, %22)
      : (<Any(Tensor)[Float32], (-2)>, <Tensor[Float32], (128, 4096)>) -> (<Negligible(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %24(CNode_106) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_mul(I64(2), %23)
      : (<Int64, NoShape>, <Negligible(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %25(distances) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_sub(%20, %24)
      : (<Any(Tensor)[Float64], (-2)>, <Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %26(CNode_107) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(%25)
      : (<Any(Tensor)[Float64], (-2)>) -> (<Tuple[Any(Tensor)[Float64]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %27(CNode_108) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple("axis")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %28(CNode_109) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(I64(1))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %29(CNode_110) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_make_dict(%27, %28)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[axis,],[Int64]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %30(CNode_111) = $(discrete_model_VectorQuantizerEMA_construct_13):UnpackCall_unpack_call(@argmin_112, %26, %29)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float64]], TupleShape((-2))>, <Dictionary[[axis,],[Int64]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %31(CNode_113) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%30, "unsqueeze")
      : (<Any(Tensor)[Float64], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %32(encoding_indices) = $(discrete_model_VectorQuantizerEMA_construct_13):%31(I64(1))
      : (<Int64, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %33(CNode_122) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%32, "shape")
      : (<Any(Tensor)[Float64], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %34(CNode_123) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_getitem(%33, I64(1))
      : (<Any(Tensor)[Float64], (-2)>, <Int64, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %35(CNode_124) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_make_range(%34)
      : (<Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %36(CNode_125) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_inner_len(%35)
      : (<Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %37(CNode_129) = MultitypeFuncGraph_less{(List, List), (Tensor, Number), (Tensor, Tensor), (Tuple, Tuple), (Number, Tensor), (String, String), (Number, Number)}(%para2_@CNode_82, %36)
      : (<Int64, NoShape>, <Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %38(CNode_130) = Switch(%37, @↻discrete_model_VectorQuantizerEMA_construct_79, @↓discrete_model_VectorQuantizerEMA_construct_131)
      : (<Any(Tensor)[Float64], (-2)>, <Func, NoShape>, <Func, NoShape>) -> (<Func, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/

#------------------------> 1
  %39(CNode_132) = %38()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  Return(%39)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
}
# Order:
#   1: @↵discrete_model_VectorQuantizerEMA_construct_81:CNode_129{[0]: ValueNode<MultitypeFuncGraph> MetaFuncGraph-less.40, [1]: param_@CNode_82, [2]: CNode_125}
#   2: @↵discrete_model_VectorQuantizerEMA_construct_81:CNode_130{[0]: ValueNode<Primitive> Switch, [1]: CNode_129, [2]: ValueNode<FuncGraph> ↻discrete_model_VectorQuantizerEMA_construct_79, [3]: ValueNode<FuncGraph> ↓discrete_model_VectorQuantizerEMA_construct_131}
#   3: @↵discrete_model_VectorQuantizerEMA_construct_81:CNode_132{[0]: CNode_130}
#   4: @↵discrete_model_VectorQuantizerEMA_construct_81:CNode_133{[0]: ValueNode<Primitive> Return, [1]: CNode_132}


subgraph attr:
subgraph instance: ↻discrete_model_VectorQuantizerEMA_construct_79 : 0x72d6f880
# In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:60/    def construct(self, inputs):/
subgraph @↻discrete_model_VectorQuantizerEMA_construct_79 parent: [subgraph @↵discrete_model_VectorQuantizerEMA_construct_81]() {
  %1(CNode_82) = MultitypeFuncGraph_add{(COOTensor, COOTensor), (CSRTensor, CSRTensor), (Number, Number), (String, String), (Tensor, List), (Tuple, Tuple), (Dictionary, Dictionary), (Tensor, Number), (Number, Tensor), (Tuple, Tensor), (Tensor, Tuple), (COOTensor, Tensor), (List, List), (Tensor, COOTensor), (Tensor, Tensor), (List, Tensor), (RowTensor, Tensor), (NoneType, NoneType)}(%para2_@CNode_82, I64(1))
      : (<Int64, NoShape>, <Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %2(CNode_134) = StopGradient(%1)
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:60/    def construct(self, inputs):/
  %3(CNode_83) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%para1_inputs, "permute")
      : (<Tensor[Float32], (8, 128, 32, 32)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %4(CNode_84) = $(discrete_model_VectorQuantizerEMA_construct_13):%3(I64(0), I64(2), I64(3), I64(1))
      : (<Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>) -> (<Tensor[Float32], (8, 32, 32, 128)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %5(CNode_85) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%4, "contiguous")
      : (<Tensor[Float32], (8, 32, 32, 128)>, <String, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %6(inputs) = $(discrete_model_VectorQuantizerEMA_construct_13):%5()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %7(CNode_86) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%6, "view")
      : (<Any(Tensor)[Float32], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %8(CNode_87) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_negative(I64(1))
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %9(flat_input) = $(discrete_model_VectorQuantizerEMA_construct_13):%7(%8, I64(128))
      : (<Int64, NoShape>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:66/        flat_input = inputs.view(-1, self._embedding_dim)/
  %10(CNode_88) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_pow(%9, I64(2))
      : (<Any(Tensor)[Float32], (-2)>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %11(CNode_89) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(%10)
      : (<Any(Tensor)[Float32], (-2)>) -> (<Tuple[Any(Tensor)[Float32]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %12(CNode_90) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple("dim", "keepdim")
      : (<String, NoShape>, <String, NoShape>) -> (<Tuple[String*2], TupleShape(NoShape, NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %13(CNode_91) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(I64(1), Bool(1))
      : (<Int64, NoShape>, <Bool, NoShape>) -> (<Tuple[Int64,Bool], TupleShape(NoShape, NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %14(CNode_92) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_make_dict(%12, %13)
      : (<Tuple[String*2], TupleShape(NoShape, NoShape)>, <Tuple[Int64,Bool], TupleShape(NoShape, NoShape)>) -> (<Dictionary[[dim,keepdim,],[Int64,Bool]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %15(CNode_93) = $(discrete_model_VectorQuantizerEMA_construct_13):UnpackCall_unpack_call(@sum_94, %11, %14)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float32]], TupleShape((-2))>, <Dictionary[[dim,keepdim,],[Int64,Bool]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %16(CNode_95) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_pow(Tensor(shape=[4096, 128], dtype=Float32, value=[...]), I64(2))
      : (<Tensor[Float32], (4096, 128)>, <Int64, NoShape>) -> (<Any(Tensor)[Float32], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %17(CNode_96) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(%16)
      : (<Any(Tensor)[Float32], (-2)>) -> (<Tuple[Any(Tensor)[Float32]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %18(CNode_97) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple("dim")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %19(CNode_98) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(I64(1))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %20(CNode_99) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_make_dict(%18, %19)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[dim,],[Int64]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %21(CNode_100) = $(discrete_model_VectorQuantizerEMA_construct_13):UnpackCall_unpack_call(@sum_94, %17, %20)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float32]], TupleShape((-2))>, <Dictionary[[dim,],[Int64]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  %22(CNode_101) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_add(%15, %21)
      : (<Any(Tensor)[Float64], (-2)>, <Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %23(CNode_102) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(Tensor(shape=[4096, 128], dtype=Float32, value=[...]), "t")
      : (<Tensor[Float32], (4096, 128)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %24(CNode_103) = $(discrete_model_VectorQuantizerEMA_construct_13):%23()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %25(CNode_105) = $(discrete_model_VectorQuantizerEMA_construct_13):call @matmul_104(%9, %24)
      : (<Any(Tensor)[Float32], (-2)>, <Tensor[Float32], (128, 4096)>) -> (<Negligible(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %26(CNode_106) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_mul(I64(2), %25)
      : (<Int64, NoShape>, <Negligible(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  %27(distances) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_sub(%22, %26)
      : (<Any(Tensor)[Float64], (-2)>, <Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:69/        distances = (ops.sum(flat_input ** 2, dim=1, keepdim=True)/
  %28(CNode_107) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(%27)
      : (<Any(Tensor)[Float64], (-2)>) -> (<Tuple[Any(Tensor)[Float64]], TupleShape((-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %29(CNode_108) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple("axis")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %30(CNode_109) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_MakeTuple(I64(1))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %31(CNode_110) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_make_dict(%29, %30)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[axis,],[Int64]], NoShape>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %32(CNode_111) = $(discrete_model_VectorQuantizerEMA_construct_13):UnpackCall_unpack_call(@argmin_112, %28, %31)
      : (<Func, NoShape>, <Tuple[Any(Tensor)[Float64]], TupleShape((-2))>, <Dictionary[[axis,],[Int64]], NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %33(CNode_113) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%32, "unsqueeze")
      : (<Any(Tensor)[Float64], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %34(encoding_indices) = $(discrete_model_VectorQuantizerEMA_construct_13):%33(I64(1))
      : (<Int64, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  %35(CNode_122) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%34, "shape")
      : (<Any(Tensor)[Float64], (-2)>, <String, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %36(CNode_123) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_getitem(%35, I64(1))
      : (<Any(Tensor)[Float64], (-2)>, <Int64, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %37(CNode_124) = $(discrete_model_VectorQuantizerEMA_construct_13):S_Prim_make_range(%36)
      : (<Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %38(CNode_135) = call @ms_iter_78(%37)
      : (<Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %39(i) = S_Prim_getitem(%38, %para2_@CNode_82)
      : (<Any(Tensor)[Float64], (-2)>, <Int64, NoShape>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  %40(CNode_136) = S_Prim_getitem(%34, %39)
      : (<Any(Tensor)[Float64], (-2)>, <Any(Tensor)[Float64], (-2)>) -> (<Any(Tensor)[Float64], (-2)>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:78/            encodings[i, encoding_indices[i]] = 1/
  %41(CNode_137) = S_Prim_MakeTuple(%39, %40)
      : (<Any(Tensor)[Float64], (-2)>, <Any(Tensor)[Float64], (-2)>) -> (<Tuple[Any(Tensor)[Float64]*2], TupleShape((-2), (-2))>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:78/            encodings[i, encoding_indices[i]] = 1/

#------------------------> 2
  %42(CNode_138) = S_Prim_setitem(%para3_фencodings, %41, I64(1))
      : (<Any(Tensor)[Float32], (-2)>, <Tuple[Any(Tensor)[Float64]*2], TupleShape((-2), (-2))>, <Int64, NoShape>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:78/            encodings[i, encoding_indices[i]] = 1/
  %43(CNode_139) = call @↵discrete_model_VectorQuantizerEMA_construct_81(%1, %42)
      : (<Int64, NoShape>, <null>) -> (<null>)
      #scope: (Default)
  %44(CNode_140) = Depend[side_effect_propagate: I64(1)](%43, %2)
      : (<null>, <Int64, NoShape>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
  Return(%44)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:77/        for i in range(encoding_indices.shape[1]):/
}
# Order:
#   1: @↻discrete_model_VectorQuantizerEMA_construct_79:CNode_135{[0]: ValueNode<FuncGraph> ms_iter_78, [1]: CNode_124}
#   2: @↻discrete_model_VectorQuantizerEMA_construct_79:i{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_135, [2]: param_@CNode_82}
#   3: @↻discrete_model_VectorQuantizerEMA_construct_79:CNode_82{[0]: ValueNode<MultitypeFuncGraph> MetaFuncGraph-add.6, [1]: param_@CNode_82, [2]: ValueNode<Int64Imm> 1}
#   4: @↻discrete_model_VectorQuantizerEMA_construct_79:CNode_136{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: encoding_indices, [2]: i}
#   5: @↻discrete_model_VectorQuantizerEMA_construct_79:CNode_137{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: i, [2]: CNode_136}
#   6: @↻discrete_model_VectorQuantizerEMA_construct_79:CNode_138{[0]: ValueNode<DoSignaturePrimitive> S_Prim_setitem, [1]: param_фencodings, [2]: CNode_137, [3]: ValueNode<Int64Imm> 1}
#   7: @↻discrete_model_VectorQuantizerEMA_construct_79:CNode_141{[0]: ValueNode<Primitive> Return, [1]: CNode_140}
#   8: @↻discrete_model_VectorQuantizerEMA_construct_79:CNode_139{[0]: ValueNode<FuncGraph> ↵discrete_model_VectorQuantizerEMA_construct_81, [1]: CNode_82, [2]: CNode_138}


# ===============================================================================================
# The total of function graphs in evaluation stack: 3/4 (Ignored 1 internal frames).
# ===============================================================================================


# ===============================================================================================
# The rest function graphs are the following:
# ===============================================================================================
subgraph attr:
subgraph instance: matmul_104 : 0x6fa0af90
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_104(%para4_input, %para5_other) {
  %1(CNode_142) = S_Prim_isinstance(%para4_input, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %2(CNode_143) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %3(CNode_144) = Switch(%2, @↰matmul_31, @↱matmul_32)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %4(CNode_145) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %5(CNode_146) = S_Prim_logical_not(%4)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %6(CNode_147) = Cond(%5, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %7(CNode_148) = Switch(%6, @✓matmul_33, @✗matmul_34)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %8(CNode_149) = %7()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  Return(%8)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
}
# Order:
#   1: @matmul_104:CNode_142{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_input, [2]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor'}
#   2: @matmul_104:CNode_143{[0]: ValueNode<Primitive> Cond, [1]: CNode_142, [2]: ValueNode<BoolImm> false}
#   3: @matmul_104:CNode_144{[0]: ValueNode<Primitive> Switch, [1]: CNode_143, [2]: ValueNode<FuncGraph> ↰matmul_31, [3]: ValueNode<FuncGraph> ↱matmul_32}
#   4: @matmul_104:CNode_145{[0]: CNode_144}
#   5: @matmul_104:CNode_146{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_145}
#   6: @matmul_104:CNode_147{[0]: ValueNode<Primitive> Cond, [1]: CNode_146, [2]: ValueNode<BoolImm> false}
#   7: @matmul_104:CNode_148{[0]: ValueNode<Primitive> Switch, [1]: CNode_147, [2]: ValueNode<FuncGraph> ✓matmul_33, [3]: ValueNode<FuncGraph> ✗matmul_34}
#   8: @matmul_104:CNode_149{[0]: CNode_148}
#   9: @matmul_104:CNode_150{[0]: ValueNode<Primitive> Return, [1]: CNode_149}


subgraph attr:
subgraph instance: sum_94 : 0x73b17420
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_94(%para6_input, %para7_dim, %para8_keepdim, %para9_dtype) {
  %1(CNode_151) = S_Prim_isinstance(%para6_input, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  %2(CNode_152) = S_Prim_logical_not(%1)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  %3(CNode_153) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  %4(CNode_154) = Switch(%3, @✓sum_155, @✗sum_156)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  %5(CNode_157) = %4()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
}
# Order:
#   1: @sum_94:CNode_151{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_input, [2]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor'}
#   2: @sum_94:CNode_152{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_151}
#   3: @sum_94:CNode_153{[0]: ValueNode<Primitive> Cond, [1]: CNode_152, [2]: ValueNode<BoolImm> false}
#   4: @sum_94:CNode_154{[0]: ValueNode<Primitive> Switch, [1]: CNode_153, [2]: ValueNode<FuncGraph> ✓sum_155, [3]: ValueNode<FuncGraph> ✗sum_156}
#   5: @sum_94:CNode_157{[0]: CNode_154}
#   6: @sum_94:CNode_158{[0]: ValueNode<Primitive> Return, [1]: CNode_157}


subgraph attr:
subgraph instance: argmin_112 : 0x706f3b70
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @argmin_112(%para10_input, %para11_axis, %para12_keepdims) {
  %1(CNode_159) = getattr(%para10_input, "shape")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  %2(CNode_160) = S_Prim_logical_not(%1)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  %3(CNode_161) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  %4(CNode_162) = Switch(%3, @✓argmin_163, @✗argmin_164)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  %5(CNode_165) = %4()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
}
# Order:
#   1: @argmin_112:CNode_159{[0]: ValueNode<Primitive> getattr, [1]: param_input, [2]: ValueNode<StringImm> shape}
#   2: @argmin_112:CNode_160{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_159}
#   3: @argmin_112:CNode_161{[0]: ValueNode<Primitive> Cond, [1]: CNode_160, [2]: ValueNode<BoolImm> false}
#   4: @argmin_112:CNode_162{[0]: ValueNode<Primitive> Switch, [1]: CNode_161, [2]: ValueNode<FuncGraph> ✓argmin_163, [3]: ValueNode<FuncGraph> ✗argmin_164}
#   5: @argmin_112:CNode_165{[0]: CNode_162}
#   6: @argmin_112:CNode_166{[0]: ValueNode<Primitive> Return, [1]: CNode_165}


subgraph attr:
subgraph instance: zeros_117 : 0x708277a0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @zeros_117(%para13_size, %para14_dtype) {
  %1(CNode_167) = S_Prim_isinstance(%para13_size, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
  %2(CNode_168) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
  %3(CNode_169) = Switch(%2, @✓zeros_170, @✗zeros_171)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
  %4(CNode_172) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
  %5(CNode_174) = call @↓zeros_173(%4)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:75/        encodings = ops.zeros((encoding_indices.shape[0], self._num_embeddings))    #.to(inputs.device)  # question/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
}
# Order:
#   1: @zeros_117:CNode_175{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.array_ops.FillV2'}
#   2: @zeros_117:zero_op{[0]: CNode_175}
#   3: @zeros_117:CNode_177{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_, [1]: param_dtype, [2]: ValueNode<None> None}
#   4: @zeros_117:CNode_178{[0]: ValueNode<Primitive> Cond, [1]: CNode_177, [2]: ValueNode<BoolImm> false}
#   5: @zeros_117:CNode_179{[0]: ValueNode<Primitive> Switch, [1]: CNode_178, [2]: ValueNode<FuncGraph> ↰zeros_180, [3]: ValueNode<FuncGraph> ↱zeros_181}
#   6: @zeros_117:_dtype{[0]: CNode_179}
#   7: @zeros_117:CNode_182{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> _dtype}
#   8: @zeros_117:CNode_183{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: _dtype}
#   9: @zeros_117:CNode_184{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_182, [2]: CNode_183}
#  10: @zeros_117:value{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'Tensor(0, _dtype)', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'_get_cache_prim': <function _get_cache_prim at 0x7fcd09d06790>, 'P': <module 'mindspore.ops.operations' from '/home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/operations/__init__.py'>, 'mstype': <module 'mindspore.common.dtype' from '/home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/common/dtype.py'>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>}), [3]: CNode_184}
#  11: @zeros_117:CNode_167{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_size, [2]: ValueNode<ClassType> class 'int'}
#  12: @zeros_117:CNode_168{[0]: ValueNode<Primitive> Cond, [1]: CNode_167, [2]: ValueNode<BoolImm> false}
#  13: @zeros_117:CNode_169{[0]: ValueNode<Primitive> Switch, [1]: CNode_168, [2]: ValueNode<FuncGraph> ✓zeros_170, [3]: ValueNode<FuncGraph> ✗zeros_171}
#  14: @zeros_117:CNode_172{[0]: CNode_169}
#  15: @zeros_117:CNode_174{[0]: ValueNode<FuncGraph> ↓zeros_173, [1]: CNode_172}
#  16: @zeros_117:CNode_185{[0]: ValueNode<Primitive> Return, [1]: CNode_174}


subgraph attr:
subgraph instance: ↓discrete_model_VectorQuantizerEMA_construct_131 : 0x73a8a610
# In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:60/    def construct(self, inputs):/
subgraph @↓discrete_model_VectorQuantizerEMA_construct_131 parent: [subgraph @↵discrete_model_VectorQuantizerEMA_construct_81]() {
  %1(CNode_187) = call @✗↓discrete_model_VectorQuantizerEMA_construct_186()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:83/        if self.training:/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:83/        if self.training:/
}
# Order:
#   1: @↓discrete_model_VectorQuantizerEMA_construct_131:CNode_188{[0]: ValueNode<FuncGraph> matmul_104, [1]: param_фencodings, [2]: ValueNode<Tensor> Tensor(shape=[4096, 128], dtype=Float32, value=[...])}
#   2: @↓discrete_model_VectorQuantizerEMA_construct_131:CNode_189{[0]: ValueNode<Primitive> getattr, [1]: CNode_188, [2]: ValueNode<StringImm> view}
#   3: @↓discrete_model_VectorQuantizerEMA_construct_131:quantized{[0]: CNode_189, [1]: input_shape}
#   4: @↓discrete_model_VectorQuantizerEMA_construct_131:CNode_187{[0]: ValueNode<FuncGraph> ✗↓discrete_model_VectorQuantizerEMA_construct_186}
#   5: @↓discrete_model_VectorQuantizerEMA_construct_131:CNode_190{[0]: ValueNode<Primitive> Return, [1]: CNode_187}


subgraph attr:
subgraph instance: ✓matmul_33 : 0x73a7a080
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @✓matmul_33() {
  %1(CNode_191) = raise[side_effect_io: Bool(1)]("TypeError", "For matmul op, inputs must be all tensors.", "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9660/        raise TypeError("For matmul op, inputs must be all tensors.")/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9660/        raise TypeError("For matmul op, inputs must be all tensors.")/
}
# Order:
#   1: @✓matmul_33:CNode_191{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: ValueNode<StringImm> For matmul op, inputs must be all tensors., [3]: ValueNode<StringImm> None}
#   2: @✓matmul_33:CNode_192{[0]: ValueNode<Primitive> Return, [1]: CNode_191}


subgraph attr:
subgraph instance: ✗matmul_34 : 0x7078bcc0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @✗matmul_34 parent: [subgraph @matmul_104]() {
  %1(CNode_194) = call @↓matmul_193()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
}
# Order:
#   1: @✗matmul_34:CNode_194{[0]: ValueNode<FuncGraph> ↓matmul_193}
#   2: @✗matmul_34:CNode_195{[0]: ValueNode<Primitive> Return, [1]: CNode_194}


subgraph attr:
subgraph instance: ↰matmul_31 : 0x707c6bc0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @↰matmul_31 parent: [subgraph @matmul_104]() {
  %1(CNode_196) = S_Prim_isinstance(%para5_other, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
}
# Order:
#   1: @↰matmul_31:CNode_196{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_other, [2]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor'}
#   2: @↰matmul_31:CNode_197{[0]: ValueNode<Primitive> Return, [1]: CNode_196}


subgraph attr:
subgraph instance: ↱matmul_32 : 0x73b756c0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @↱matmul_32 parent: [subgraph @matmul_104]() {
  %1(CNode_142) = $(matmul_104):S_Prim_isinstance(%para4_input, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
}
# Order:
#   1: @↱matmul_32:CNode_198{[0]: ValueNode<Primitive> Return, [1]: CNode_142}


subgraph attr:
subgraph instance: ✓sum_155 : 0x73b57b70
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✓sum_155 parent: [subgraph @sum_94]() {
  %1(CNode_199) = S_Prim_MakeTuple("input")
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  %2(CNode_200) = S_Prim_MakeTuple(%para6_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  %3(CNode_201) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  %4(CNode_202) = PyInterpret[side_effect_io: Bool(1)](Script['f"For 'sum', 'input' must be Tensor, but got{type(input)}"'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  %5(CNode_203) = raise[side_effect_io: Bool(1)]("TypeError", %4, "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
}
# Order:
#   1: @✓sum_155:CNode_199{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> input}
#   2: @✓sum_155:CNode_200{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_input}
#   3: @✓sum_155:CNode_201{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_199, [2]: CNode_200}
#   4: @✓sum_155:CNode_202{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'f"For 'sum', 'input' must be Tensor, but got{type(input)}"', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'isinstance': <built-in function isinstance>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>, 'type': <class 'type'>}), [3]: CNode_201}
#   5: @✓sum_155:CNode_203{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: CNode_202, [3]: ValueNode<StringImm> None}
#   6: @✓sum_155:CNode_204{[0]: ValueNode<Primitive> Return, [1]: CNode_203}


subgraph attr:
subgraph instance: ✗sum_156 : 0x7051b7f0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✗sum_156 parent: [subgraph @sum_94]() {
  %1(CNode_206) = call @↓sum_205()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
}
# Order:
#   1: @✗sum_156:CNode_206{[0]: ValueNode<FuncGraph> ↓sum_205}
#   2: @✗sum_156:CNode_207{[0]: ValueNode<Primitive> Return, [1]: CNode_206}


subgraph attr:
subgraph instance: ✓argmin_163 : 0x73b43870
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @✓argmin_163() {
  %1(CNode_208) = S_Prim_MakeTuple()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
  %2(CNode_209) = S_Prim_MakeTuple()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
  %3(CNode_210) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
  %4(CNode_211) = PyInterpret[side_effect_io: Bool(1)](Script['Tensor(0)'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
  Return(%4)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
}
# Order:
#   1: @✓argmin_163:CNode_208{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple}
#   2: @✓argmin_163:CNode_209{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple}
#   3: @✓argmin_163:CNode_210{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_208, [2]: CNode_209}
#   4: @✓argmin_163:CNode_211{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'Tensor(0)', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'Tensor': <class 'mindspore.common.tensor.Tensor'>}), [3]: CNode_210}
#   5: @✓argmin_163:CNode_212{[0]: ValueNode<Primitive> Return, [1]: CNode_211}


subgraph attr:
subgraph instance: ✗argmin_164 : 0x706dd110
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @✗argmin_164 parent: [subgraph @argmin_112]() {
  %1(CNode_214) = call @↓argmin_213()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
}
# Order:
#   1: @✗argmin_164:CNode_214{[0]: ValueNode<FuncGraph> ↓argmin_213}
#   2: @✗argmin_164:CNode_215{[0]: ValueNode<Primitive> Return, [1]: CNode_214}


subgraph attr:
subgraph instance: ↰zeros_180 : 0x70837380
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
subgraph @↰zeros_180() {
  Return(F32)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
}
# Order:
#   1: @↰zeros_180:CNode_216{[0]: ValueNode<Primitive> Return, [1]: ValueNode<Float> Float32}


subgraph attr:
subgraph instance: ↱zeros_181 : 0x70886090
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
subgraph @↱zeros_181 parent: [subgraph @zeros_117]() {
  Return(%para14_dtype)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
}
# Order:
#   1: @↱zeros_181:CNode_217{[0]: ValueNode<Primitive> Return, [1]: param_dtype}


subgraph attr:
after_block : 1
subgraph instance: ↓zeros_173 : 0x70887bc0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @↓zeros_173 parent: [subgraph @zeros_117](%para15_) {
  %1(CNode_175) = $(zeros_117):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1031/    zero_op = _get_cache_prim(P.FillV2)()/
  %2(zero_op) = $(zeros_117):%1()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1031/    zero_op = _get_cache_prim(P.FillV2)()/
  %3(CNode_182) = $(zeros_117):S_Prim_MakeTuple("_dtype")
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1033/    value = Tensor(0, _dtype)/
  %4(CNode_177) = $(zeros_117):S_Prim_is_(%para14_dtype, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
  %5(CNode_178) = $(zeros_117):Cond(%4, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
  %6(CNode_179) = $(zeros_117):Switch(%5, @↰zeros_180, @↱zeros_181)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
  %7(_dtype) = $(zeros_117):%6()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
  %8(CNode_183) = $(zeros_117):S_Prim_MakeTuple(%7)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1033/    value = Tensor(0, _dtype)/
  %9(CNode_184) = $(zeros_117):S_Prim_make_dict(%3, %8)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1033/    value = Tensor(0, _dtype)/
  %10(value) = $(zeros_117):PyInterpret[side_effect_io: Bool(1)](Script['Tensor(0, _dtype)'], InterpretedObject, %9)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1033/    value = Tensor(0, _dtype)/
  %11(output) = %2(%para15_фsize, %10)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1040/    output = zero_op(size, value)/
  Return(%11)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1041/    return output/
}
# Order:
#   1: @↓zeros_173:output{[0]: zero_op, [1]: param_фsize, [2]: value}
#   2: @↓zeros_173:CNode_218{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
subgraph instance: ✓zeros_170 : 0x70886550
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @✓zeros_170 parent: [subgraph @zeros_117]() {
  %1(CNode_219) = S_Prim_make_list(%para13_size)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1035/        size = tuple([size])/
  %2(size) = ClassType(%1)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1035/        size = tuple([size])/
  Return(%2)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1035/        size = tuple([size])/
}
# Order:
#   1: @✓zeros_170:CNode_219{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_list, [1]: param_size}
#   2: @✓zeros_170:size{[0]: ValueNode<ClassType> class 'tuple', [1]: CNode_219}
#   3: @✓zeros_170:CNode_220{[0]: ValueNode<Primitive> Return, [1]: size}


subgraph attr:
subgraph instance: ✗zeros_171 : 0x708135c0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @✗zeros_171 parent: [subgraph @zeros_117]() {
  %1(CNode_221) = S_Prim_isinstance(%para13_size, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
  %2(CNode_222) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
  %3(CNode_223) = Switch(%2, @✓✗zeros_224, @2✗zeros_225)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
  %4(CNode_226) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
  Return(%4)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
}
# Order:
#   1: @✗zeros_171:CNode_221{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_size, [2]: ValueNode<ClassType> class 'list'}
#   2: @✗zeros_171:CNode_222{[0]: ValueNode<Primitive> Cond, [1]: CNode_221, [2]: ValueNode<BoolImm> false}
#   3: @✗zeros_171:CNode_223{[0]: ValueNode<Primitive> Switch, [1]: CNode_222, [2]: ValueNode<FuncGraph> ✓✗zeros_224, [3]: ValueNode<FuncGraph> 2✗zeros_225}
#   4: @✗zeros_171:CNode_226{[0]: CNode_223}
#   5: @✗zeros_171:CNode_227{[0]: ValueNode<Primitive> Return, [1]: CNode_226}


subgraph attr:
subgraph instance: _get_cache_prim_176 : 0x708a65f0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:35/def _get_cache_prim(cls: Primitive) -> Primitive:/
subgraph @_get_cache_prim_176(%para16_cls) {
  %1(CNode_229) = call @✓_get_cache_prim_228()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:88/    if _is_need_compile(_temp_func): # @jit.cond: True/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:88/    if _is_need_compile(_temp_func): # @jit.cond: True/
}
# Order:
#   1: @_get_cache_prim_176:CNode_229{[0]: ValueNode<FuncGraph> ✓_get_cache_prim_228}
#   2: @_get_cache_prim_176:CNode_230{[0]: ValueNode<Primitive> Return, [1]: CNode_229}


subgraph attr:
subgraph instance: ms_iter_78 : 0x708ae350
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/_extends/parse/standard_method.py:2345/def ms_iter(xs):/
subgraph @ms_iter_78(%para17_xs) {
  %1(CNode_231) = getattr(%para17_xs, "__ms_iter__")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/_extends/parse/standard_method.py:2347/    return xs.__ms_iter__/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/_extends/parse/standard_method.py:2347/    return xs.__ms_iter__/
}
# Order:
#   1: @ms_iter_78:CNode_231{[0]: ValueNode<Primitive> getattr, [1]: param_xs, [2]: ValueNode<StringImm> __ms_iter__}
#   2: @ms_iter_78:CNode_232{[0]: ValueNode<Primitive> Return, [1]: CNode_231}


subgraph attr:
subgraph instance: ✗↓discrete_model_VectorQuantizerEMA_construct_186 : 0x70745280
# In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:60/    def construct(self, inputs):/
subgraph @✗↓discrete_model_VectorQuantizerEMA_construct_186 parent: [subgraph @↓discrete_model_VectorQuantizerEMA_construct_131]() {
  %1(CNode_234) = call @2↓discrete_model_VectorQuantizerEMA_construct_233()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:83/        if self.training:/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:83/        if self.training:/
}
# Order:
#   1: @✗↓discrete_model_VectorQuantizerEMA_construct_186:CNode_234{[0]: ValueNode<FuncGraph> 2↓discrete_model_VectorQuantizerEMA_construct_233}
#   2: @✗↓discrete_model_VectorQuantizerEMA_construct_186:CNode_235{[0]: ValueNode<Primitive> Return, [1]: CNode_234}


subgraph attr:
after_block : 1
subgraph instance: ↓matmul_193 : 0x707407f0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @↓matmul_193 parent: [subgraph @matmul_104]() {
  %1(CNode_236) = S_Prim_Rank(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %2(CNode_237) = S_Prim_Rank(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %3(CNode_238) = S_Prim_MakeTuple(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %4(input_rank) = S_Prim_getitem(%3, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %5(CNode_239) = S_Prim_equal(%4, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %6(CNode_240) = Cond(%5, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %7(CNode_241) = Switch(%6, @↰↓matmul_35, @↱↓matmul_36)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %8(CNode_242) = %7()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %9(CNode_243) = Cond(%8, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %10(CNode_244) = Switch(%9, @✓↓matmul_37, @✗↓matmul_38)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %11(CNode_245) = %10()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  Return(%11)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
}
# Order:
#   1: @↓matmul_193:CNode_236{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: param_input}
#   2: @↓matmul_193:CNode_237{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: param_other}
#   3: @↓matmul_193:CNode_238{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_236, [2]: CNode_237}
#   4: @↓matmul_193:input_rank{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_238, [2]: ValueNode<Int64Imm> 0}
#   5: @↓matmul_193:other_rank{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_238, [2]: ValueNode<Int64Imm> 1}
#   6: @↓matmul_193:CNode_239{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: input_rank, [2]: ValueNode<Int64Imm> 2}
#   7: @↓matmul_193:CNode_240{[0]: ValueNode<Primitive> Cond, [1]: CNode_239, [2]: ValueNode<BoolImm> false}
#   8: @↓matmul_193:CNode_241{[0]: ValueNode<Primitive> Switch, [1]: CNode_240, [2]: ValueNode<FuncGraph> ↰↓matmul_35, [3]: ValueNode<FuncGraph> ↱↓matmul_36}
#   9: @↓matmul_193:CNode_242{[0]: CNode_241}
#  10: @↓matmul_193:CNode_243{[0]: ValueNode<Primitive> Cond, [1]: CNode_242, [2]: ValueNode<BoolImm> false}
#  11: @↓matmul_193:CNode_244{[0]: ValueNode<Primitive> Switch, [1]: CNode_243, [2]: ValueNode<FuncGraph> ✓↓matmul_37, [3]: ValueNode<FuncGraph> ✗↓matmul_38}
#  12: @↓matmul_193:CNode_245{[0]: CNode_244}
#  13: @↓matmul_193:CNode_246{[0]: ValueNode<Primitive> Return, [1]: CNode_245}


subgraph attr:
after_block : 1
subgraph instance: ↓sum_205 : 0x7076a830
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @↓sum_205 parent: [subgraph @sum_94]() {
  %1(CNode_247) = S_Prim_is_not(%para7_dim, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %2(CNode_248) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %3(CNode_249) = Switch(%2, @↰↓sum_250, @↱↓sum_251)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %4(CNode_252) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %5(CNode_253) = Cond(%4, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %6(CNode_254) = Switch(%5, @✓↓sum_255, @✗↓sum_256)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %7(CNode_257) = %6()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
}
# Order:
#   1: @↓sum_205:CNode_247{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_not, [1]: param_dim, [2]: ValueNode<None> None}
#   2: @↓sum_205:CNode_248{[0]: ValueNode<Primitive> Cond, [1]: CNode_247, [2]: ValueNode<BoolImm> false}
#   3: @↓sum_205:CNode_249{[0]: ValueNode<Primitive> Switch, [1]: CNode_248, [2]: ValueNode<FuncGraph> ↰↓sum_250, [3]: ValueNode<FuncGraph> ↱↓sum_251}
#   4: @↓sum_205:CNode_252{[0]: CNode_249}
#   5: @↓sum_205:CNode_253{[0]: ValueNode<Primitive> Cond, [1]: CNode_252, [2]: ValueNode<BoolImm> false}
#   6: @↓sum_205:CNode_254{[0]: ValueNode<Primitive> Switch, [1]: CNode_253, [2]: ValueNode<FuncGraph> ✓↓sum_255, [3]: ValueNode<FuncGraph> ✗↓sum_256}
#   7: @↓sum_205:CNode_257{[0]: CNode_254}
#   8: @↓sum_205:CNode_258{[0]: ValueNode<Primitive> Return, [1]: CNode_257}


subgraph attr:
after_block : 1
subgraph instance: ↓argmin_213 : 0x707721a0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @↓argmin_213 parent: [subgraph @argmin_112]() {
  %1(CNode_259) = S_Prim_is_(%para11_axis, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
  %2(CNode_260) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
  %3(CNode_261) = Switch(%2, @✓↓argmin_262, @✗↓argmin_263)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
  %4(CNode_264) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
  Return(%4)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
}
# Order:
#   1: @↓argmin_213:CNode_259{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_, [1]: param_axis, [2]: ValueNode<None> None}
#   2: @↓argmin_213:CNode_260{[0]: ValueNode<Primitive> Cond, [1]: CNode_259, [2]: ValueNode<BoolImm> false}
#   3: @↓argmin_213:CNode_261{[0]: ValueNode<Primitive> Switch, [1]: CNode_260, [2]: ValueNode<FuncGraph> ✓↓argmin_262, [3]: ValueNode<FuncGraph> ✗↓argmin_263}
#   4: @↓argmin_213:CNode_264{[0]: CNode_261}
#   5: @↓argmin_213:CNode_265{[0]: ValueNode<Primitive> Return, [1]: CNode_264}


subgraph attr:
subgraph instance: ✓✗zeros_224 : 0x708882c0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @✓✗zeros_224 parent: [subgraph @zeros_117]() {
  %1(CNode_266) = S_Prim_MakeTuple("size")
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
  %2(CNode_267) = S_Prim_MakeTuple(%para13_size)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
  %3(CNode_268) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
  %4(size) = PyInterpret[side_effect_io: Bool(1)](Script['Tensor(size, dtype=mstype.int64)'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
  %5(CNode_270) = call @↓✗zeros_269(%4)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:75/        encodings = ops.zeros((encoding_indices.shape[0], self._num_embeddings))    #.to(inputs.device)  # question/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
}
# Order:
#   1: @✓✗zeros_224:CNode_266{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> size}
#   2: @✓✗zeros_224:CNode_267{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_size}
#   3: @✓✗zeros_224:CNode_268{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_266, [2]: CNode_267}
#   4: @✓✗zeros_224:size{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'Tensor(size, dtype=mstype.int64)', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'_get_cache_prim': <function _get_cache_prim at 0x7fcd09d06790>, 'P': <module 'mindspore.ops.operations' from '/home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/operations/__init__.py'>, 'mstype': <module 'mindspore.common.dtype' from '/home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/common/dtype.py'>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>, 'isinstance': <built-in function isinstance>, 'int': <class 'int'>, 'tuple': <class 'tuple'>, 'list': <class 'list'>}), [3]: CNode_268}
#   5: @✓✗zeros_224:CNode_271{[0]: ValueNode<Primitive> Return, [1]: CNode_270}
#   6: @✓✗zeros_224:CNode_270{[0]: ValueNode<FuncGraph> ↓✗zeros_269, [1]: size}


subgraph attr:
subgraph instance: 2✗zeros_225 : 0x7085b100
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @2✗zeros_225 parent: [subgraph @zeros_117]() {
  %1(CNode_272) = S_Prim_isinstance(%para13_size, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %2(CNode_273) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %3(CNode_274) = Switch(%2, @↰2✗zeros_275, @↱2✗zeros_276)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %4(CNode_277) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %5(CNode_278) = Cond(%4, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %6(CNode_279) = Switch(%5, @✓2✗zeros_280, @3✗zeros_281)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %7(CNode_282) = %6()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %8(CNode_284) = call @↓2✗zeros_283(%7)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:75/        encodings = ops.zeros((encoding_indices.shape[0], self._num_embeddings))    #.to(inputs.device)  # question/
  Return(%8)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @2✗zeros_225:CNode_272{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_size, [2]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor'}
#   2: @2✗zeros_225:CNode_273{[0]: ValueNode<Primitive> Cond, [1]: CNode_272, [2]: ValueNode<BoolImm> false}
#   3: @2✗zeros_225:CNode_274{[0]: ValueNode<Primitive> Switch, [1]: CNode_273, [2]: ValueNode<FuncGraph> ↰2✗zeros_275, [3]: ValueNode<FuncGraph> ↱2✗zeros_276}
#   4: @2✗zeros_225:CNode_277{[0]: CNode_274}
#   5: @2✗zeros_225:CNode_278{[0]: ValueNode<Primitive> Cond, [1]: CNode_277, [2]: ValueNode<BoolImm> false}
#   6: @2✗zeros_225:CNode_279{[0]: ValueNode<Primitive> Switch, [1]: CNode_278, [2]: ValueNode<FuncGraph> ✓2✗zeros_280, [3]: ValueNode<FuncGraph> 3✗zeros_281}
#   7: @2✗zeros_225:CNode_282{[0]: CNode_279}
#   8: @2✗zeros_225:CNode_284{[0]: ValueNode<FuncGraph> ↓2✗zeros_283, [1]: CNode_282}
#   9: @2✗zeros_225:CNode_285{[0]: ValueNode<Primitive> Return, [1]: CNode_284}


subgraph attr:
subgraph instance: ✓_get_cache_prim_228 : 0x75ea7ec0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:35/def _get_cache_prim(cls: Primitive) -> Primitive:/
subgraph @✓_get_cache_prim_228 parent: [subgraph @_get_cache_prim_176]() {
  Return(@_new_prim_for_graph_286)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:89/        return _new_prim_for_graph/
}
# Order:
#   1: @✓_get_cache_prim_228:CNode_287{[0]: ValueNode<Primitive> Return, [1]: ValueNode<FuncGraph> _new_prim_for_graph_286}


subgraph attr:
subgraph instance: 2↓discrete_model_VectorQuantizerEMA_construct_233 : 0x70781380
# In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:60/    def construct(self, inputs):/
subgraph @2↓discrete_model_VectorQuantizerEMA_construct_233 parent: [subgraph @↓discrete_model_VectorQuantizerEMA_construct_131]() {
  %1(CNode_188) = $(↓discrete_model_VectorQuantizerEMA_construct_131):call @matmul_104(%para3_фencodings, Tensor(shape=[4096, 128], dtype=Float32, value=[...]))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:81/        quantized = ops.matmul(encodings, self._embedding_weights).view(input_shape)/
  %2(CNode_189) = $(↓discrete_model_VectorQuantizerEMA_construct_131):getattr(%1, "view")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:81/        quantized = ops.matmul(encodings, self._embedding_weights).view(input_shape)/
  %3(CNode_83) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%para1_inputs, "permute")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %4(CNode_84) = $(discrete_model_VectorQuantizerEMA_construct_13):%3(I64(0), I64(2), I64(3), I64(1))
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %5(CNode_85) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%4, "contiguous")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %6(inputs) = $(discrete_model_VectorQuantizerEMA_construct_13):%5()
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:62/        inputs = inputs.permute(0, 2, 3, 1).contiguous()/
  %7(input_shape) = $(discrete_model_VectorQuantizerEMA_construct_13):getattr(%6, "shape")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:63/        input_shape = inputs.shape/
  %8(quantized) = $(↓discrete_model_VectorQuantizerEMA_construct_131):%2(%7)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:81/        quantized = ops.matmul(encodings, self._embedding_weights).view(input_shape)/
  %9(e_latent_loss) = call @mse_loss_288(%8, %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:100/        e_latent_loss = ops.mse_loss(quantized, inputs)/
  %10(loss) = S_Prim_mul(F32(0.25), %9)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:101/        loss = self._commitment_cost * e_latent_loss/
  %11(temp) = S_Prim_sub(%8, %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:104/        temp = quantized - inputs/
  %12(quantized) = S_Prim_add(%6, %11)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:106/        quantized = inputs + (temp)/
  %13(CNode_289) = S_Prim_MakeTuple(%para3_фencodings)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:107/        avg_probs = ops.mean(encodings, axis=0)/
  %14(CNode_290) = S_Prim_MakeTuple("axis")
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:107/        avg_probs = ops.mean(encodings, axis=0)/
  %15(CNode_291) = S_Prim_MakeTuple(I64(0))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:107/        avg_probs = ops.mean(encodings, axis=0)/
  %16(CNode_292) = S_Prim_make_dict(%14, %15)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:107/        avg_probs = ops.mean(encodings, axis=0)/
  %17(avg_probs) = UnpackCall_unpack_call(@mean_293, %13, %16)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:107/        avg_probs = ops.mean(encodings, axis=0)/
  %18(CNode_294) = S_Prim_add(%17, F32(1e-10))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:108/        perplexity = ops.exp(-ops.sum(avg_probs * ops.log(avg_probs + 1e-10)))/
  %19(CNode_296) = call @log_295(%18)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:108/        perplexity = ops.exp(-ops.sum(avg_probs * ops.log(avg_probs + 1e-10)))/
  %20(CNode_297) = S_Prim_mul(%17, %19)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:108/        perplexity = ops.exp(-ops.sum(avg_probs * ops.log(avg_probs + 1e-10)))/
  %21(CNode_298) = call @sum_94(%20)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:108/        perplexity = ops.exp(-ops.sum(avg_probs * ops.log(avg_probs + 1e-10)))/
  %22(CNode_299) = S_Prim_negative(%21)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:108/        perplexity = ops.exp(-ops.sum(avg_probs * ops.log(avg_probs + 1e-10)))/
  %23(perplexity) = call @exp_300(%22)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:108/        perplexity = ops.exp(-ops.sum(avg_probs * ops.log(avg_probs + 1e-10)))/
  %24(CNode_301) = S_Prim_MakeTuple(%10, %12, %23, %para3_фencodings)
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:112/        return loss, quantized, perplexity, encodings   # question: 不懂，跟你妈傻逼一样，操您妈的/
  Return(%24)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:112/        return loss, quantized, perplexity, encodings   # question: 不懂，跟你妈傻逼一样，操您妈的/
}
# Order:
#   1: @2↓discrete_model_VectorQuantizerEMA_construct_233:e_latent_loss{[0]: ValueNode<FuncGraph> mse_loss_288, [1]: quantized, [2]: inputs}
#   2: @2↓discrete_model_VectorQuantizerEMA_construct_233:loss{[0]: ValueNode<DoSignaturePrimitive> S_Prim_mul, [1]: ValueNode<FP32Imm> 0.25, [2]: e_latent_loss}
#   3: @2↓discrete_model_VectorQuantizerEMA_construct_233:temp{[0]: ValueNode<DoSignaturePrimitive> S_Prim_sub, [1]: quantized, [2]: inputs}
#   4: @2↓discrete_model_VectorQuantizerEMA_construct_233:quantized{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: inputs, [2]: temp}
#   5: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_289{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_фencodings}
#   6: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_290{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> axis}
#   7: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_291{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Int64Imm> 0}
#   8: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_292{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_290, [2]: CNode_291}
#   9: @2↓discrete_model_VectorQuantizerEMA_construct_233:avg_probs{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.302, [1]: ValueNode<FuncGraph> mean_293, [2]: CNode_289, [3]: CNode_292}
#  10: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_294{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: avg_probs, [2]: ValueNode<FP32Imm> 1e-10}
#  11: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_296{[0]: ValueNode<FuncGraph> log_295, [1]: CNode_294}
#  12: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_297{[0]: ValueNode<DoSignaturePrimitive> S_Prim_mul, [1]: avg_probs, [2]: CNode_296}
#  13: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_298{[0]: ValueNode<FuncGraph> sum_94, [1]: CNode_297}
#  14: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_299{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: CNode_298}
#  15: @2↓discrete_model_VectorQuantizerEMA_construct_233:perplexity{[0]: ValueNode<FuncGraph> exp_300, [1]: CNode_299}
#  16: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_301{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: loss, [2]: quantized, [3]: perplexity, [4]: param_фencodings}
#  17: @2↓discrete_model_VectorQuantizerEMA_construct_233:CNode_303{[0]: ValueNode<Primitive> Return, [1]: CNode_301}


subgraph attr:
subgraph instance: ✓↓matmul_37 : 0x706e1d10
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @✓↓matmul_37 parent: [subgraph @matmul_104]() {
  %1(CNode_304) = call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9664/        _matmul = _get_cache_prim(P.MatMul)(False, False)/
  %2(_matmul) = %1(Bool(0), Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9664/        _matmul = _get_cache_prim(P.MatMul)(False, False)/
  %3(CNode_305) = %2(%para4_input, %para5_other)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9665/        return _matmul(input, other)/
  Return(%3)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9665/        return _matmul(input, other)/
}
# Order:
#   1: @✓↓matmul_37:CNode_304{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.MatMul'}
#   2: @✓↓matmul_37:_matmul{[0]: CNode_304, [1]: ValueNode<BoolImm> false, [2]: ValueNode<BoolImm> false}
#   3: @✓↓matmul_37:CNode_305{[0]: _matmul, [1]: param_input, [2]: param_other}
#   4: @✓↓matmul_37:CNode_306{[0]: ValueNode<Primitive> Return, [1]: CNode_305}


subgraph attr:
subgraph instance: ✗↓matmul_38 : 0x7074fd20
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @✗↓matmul_38 parent: [subgraph @matmul_104]() {
  %1(CNode_308) = call @2↓matmul_307()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
}
# Order:
#   1: @✗↓matmul_38:CNode_308{[0]: ValueNode<FuncGraph> 2↓matmul_307}
#   2: @✗↓matmul_38:CNode_309{[0]: ValueNode<Primitive> Return, [1]: CNode_308}


subgraph attr:
subgraph instance: ↰↓matmul_35 : 0x73b2a0c0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @↰↓matmul_35 parent: [subgraph @↓matmul_193]() {
  %1(CNode_236) = $(↓matmul_193):S_Prim_Rank(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %2(CNode_237) = $(↓matmul_193):S_Prim_Rank(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %3(CNode_238) = $(↓matmul_193):S_Prim_MakeTuple(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %4(other_rank) = $(↓matmul_193):S_Prim_getitem(%3, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %5(CNode_310) = S_Prim_equal(%4, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
}
# Order:
#   1: @↰↓matmul_35:CNode_310{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: other_rank, [2]: ValueNode<Int64Imm> 2}
#   2: @↰↓matmul_35:CNode_311{[0]: ValueNode<Primitive> Return, [1]: CNode_310}


subgraph attr:
subgraph instance: ↱↓matmul_36 : 0x707a3180
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @↱↓matmul_36 parent: [subgraph @↓matmul_193]() {
  %1(CNode_236) = $(↓matmul_193):S_Prim_Rank(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %2(CNode_237) = $(↓matmul_193):S_Prim_Rank(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %3(CNode_238) = $(↓matmul_193):S_Prim_MakeTuple(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %4(input_rank) = $(↓matmul_193):S_Prim_getitem(%3, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %5(CNode_239) = $(↓matmul_193):S_Prim_equal(%4, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
}
# Order:
#   1: @↱↓matmul_36:CNode_312{[0]: ValueNode<Primitive> Return, [1]: CNode_239}


subgraph attr:
subgraph instance: ✓↓sum_255 : 0x6fa1c690
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✓↓sum_255 parent: [subgraph @sum_94]() {
  %1(CNode_313) = S_Prim_MakeTuple("dim")
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  %2(CNode_314) = S_Prim_MakeTuple(%para7_dim)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  %3(CNode_315) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  %4(CNode_316) = PyInterpret[side_effect_io: Bool(1)](Script['f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}"'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  %5(CNode_317) = raise[side_effect_io: Bool(1)]("TypeError", %4, "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
}
# Order:
#   1: @✓↓sum_255:CNode_313{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> dim}
#   2: @✓↓sum_255:CNode_314{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_dim}
#   3: @✓↓sum_255:CNode_315{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_313, [2]: CNode_314}
#   4: @✓↓sum_255:CNode_316{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}"', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'isinstance': <built-in function isinstance>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>, 'type': <class 'type'>, 'int': <class 'int'>, 'tuple': <class 'tuple'>, 'list': <class 'list'>}), [3]: CNode_315}
#   5: @✓↓sum_255:CNode_317{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: CNode_316, [3]: ValueNode<StringImm> None}
#   6: @✓↓sum_255:CNode_318{[0]: ValueNode<Primitive> Return, [1]: CNode_317}


subgraph attr:
subgraph instance: ✗↓sum_256 : 0x7079ae20
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✗↓sum_256 parent: [subgraph @sum_94]() {
  %1(CNode_320) = call @2↓sum_319()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
}
# Order:
#   1: @✗↓sum_256:CNode_320{[0]: ValueNode<FuncGraph> 2↓sum_319}
#   2: @✗↓sum_256:CNode_321{[0]: ValueNode<Primitive> Return, [1]: CNode_320}


subgraph attr:
subgraph instance: ↰↓sum_250 : 0x6fa28f80
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @↰↓sum_250 parent: [subgraph @sum_94]() {
  %1(CNode_322) = S_Prim_MakeTuple(ClassType, ClassType, ClassType)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %2(CNode_323) = S_Prim_isinstance(%para7_dim, %1)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %3(CNode_324) = S_Prim_logical_not(%2)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  Return(%3)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
}
# Order:
#   1: @↰↓sum_250:CNode_322{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<ClassType> class 'int', [2]: ValueNode<ClassType> class 'tuple', [3]: ValueNode<ClassType> class 'list'}
#   2: @↰↓sum_250:CNode_323{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_dim, [2]: CNode_322}
#   3: @↰↓sum_250:CNode_324{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_323}
#   4: @↰↓sum_250:CNode_325{[0]: ValueNode<Primitive> Return, [1]: CNode_324}


subgraph attr:
subgraph instance: ↱↓sum_251 : 0x73b160d0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @↱↓sum_251 parent: [subgraph @↓sum_205]() {
  %1(CNode_247) = $(↓sum_205):S_Prim_is_not(%para7_dim, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
}
# Order:
#   1: @↱↓sum_251:CNode_326{[0]: ValueNode<Primitive> Return, [1]: CNode_247}


subgraph attr:
subgraph instance: ✓↓argmin_262 : 0x7072d820
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @✓↓argmin_262 parent: [subgraph @argmin_112]() {
  %1(CNode_327) = S_Prim_negative(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:667/        input = reshape_(input, (-1,))/
  %2(CNode_328) = S_Prim_MakeTuple(%1)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:667/        input = reshape_(input, (-1,))/
  %3(input) = S_Prim_Reshape[output_names: ["output"], input_names: ["tensor", "shape"]](%para10_input, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:667/        input = reshape_(input, (-1,))/
  %4(CNode_330) = call @2↓argmin_329(I64(0), %3, Bool(1))
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  Return(%4)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:667/        input = reshape_(input, (-1,))/
}
# Order:
#   1: @✓↓argmin_262:CNode_327{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 1}
#   2: @✓↓argmin_262:CNode_328{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_327}
#   3: @✓↓argmin_262:input{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Reshape, [1]: param_input, [2]: CNode_328}
#   4: @✓↓argmin_262:CNode_331{[0]: ValueNode<Primitive> Return, [1]: CNode_330}
#   5: @✓↓argmin_262:CNode_330{[0]: ValueNode<FuncGraph> 2↓argmin_329, [1]: ValueNode<Int64Imm> 0, [2]: input, [3]: ValueNode<BoolImm> true}


subgraph attr:
subgraph instance: ✗↓argmin_263 : 0x7072dce0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @✗↓argmin_263 parent: [subgraph @argmin_112]() {
  %1(CNode_332) = call @2↓argmin_329(%para11_axis, %para10_input, Bool(0))
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
}
# Order:
#   1: @✗↓argmin_263:CNode_333{[0]: ValueNode<Primitive> Return, [1]: CNode_332}
#   2: @✗↓argmin_263:CNode_332{[0]: ValueNode<FuncGraph> 2↓argmin_329, [1]: param_axis, [2]: param_input, [3]: ValueNode<BoolImm> false}


subgraph attr:
after_block : 1
subgraph instance: ↓✗zeros_269 : 0x7085b850
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @↓✗zeros_269(%para18_) {
  Return(%para18_фsize)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
}
# Order:
#   1: @↓✗zeros_269:CNode_334{[0]: ValueNode<Primitive> Return, [1]: param_фsize}


subgraph attr:
after_block : 1
subgraph instance: ↓2✗zeros_283 : 0x70892b40
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @↓2✗zeros_283(%para19_) {
  %1(CNode_335) = call @↓✗zeros_269(%para19_фsize)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:75/        encodings = ops.zeros((encoding_indices.shape[0], self._num_embeddings))    #.to(inputs.device)  # question/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @↓2✗zeros_283:CNode_336{[0]: ValueNode<Primitive> Return, [1]: CNode_335}
#   2: @↓2✗zeros_283:CNode_335{[0]: ValueNode<FuncGraph> ↓✗zeros_269, [1]: param_фsize}


subgraph attr:
subgraph instance: ✓2✗zeros_280 : 0x70891bb0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @✓2✗zeros_280 parent: [subgraph @zeros_117]() {
  %1(CNode_337) = getattr(%para13_size, "reshape")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1039/        size = size.reshape(1)/
  %2(size) = %1(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1039/        size = size.reshape(1)/
  Return(%2)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1039/        size = size.reshape(1)/
}
# Order:
#   1: @✓2✗zeros_280:CNode_337{[0]: ValueNode<Primitive> getattr, [1]: param_size, [2]: ValueNode<StringImm> reshape}
#   2: @✓2✗zeros_280:size{[0]: CNode_337, [1]: ValueNode<Int64Imm> 1}
#   3: @✓2✗zeros_280:CNode_338{[0]: ValueNode<Primitive> Return, [1]: size}


subgraph attr:
subgraph instance: 3✗zeros_281 : 0x70892300
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @3✗zeros_281 parent: [subgraph @zeros_117]() {
  Return(%para13_size)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @3✗zeros_281:CNode_339{[0]: ValueNode<Primitive> Return, [1]: param_size}


subgraph attr:
subgraph instance: ↰2✗zeros_275 : 0x7087cc70
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @↰2✗zeros_275 parent: [subgraph @zeros_117]() {
  %1(CNode_340) = getattr(%para13_size, "ndim")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %2(CNode_341) = S_Prim_equal(%1, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %3(CNode_342) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %4(CNode_343) = Switch(%3, @2↰2✗zeros_344, @↱↰2✗zeros_345)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %5(CNode_346) = %4()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @↰2✗zeros_275:CNode_340{[0]: ValueNode<Primitive> getattr, [1]: param_size, [2]: ValueNode<StringImm> ndim}
#   2: @↰2✗zeros_275:CNode_341{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: CNode_340, [2]: ValueNode<Int64Imm> 0}
#   3: @↰2✗zeros_275:CNode_342{[0]: ValueNode<Primitive> Cond, [1]: CNode_341, [2]: ValueNode<BoolImm> false}
#   4: @↰2✗zeros_275:CNode_343{[0]: ValueNode<Primitive> Switch, [1]: CNode_342, [2]: ValueNode<FuncGraph> 2↰2✗zeros_344, [3]: ValueNode<FuncGraph> ↱↰2✗zeros_345}
#   5: @↰2✗zeros_275:CNode_346{[0]: CNode_343}
#   6: @↰2✗zeros_275:CNode_347{[0]: ValueNode<Primitive> Return, [1]: CNode_346}


subgraph attr:
subgraph instance: ↱2✗zeros_276 : 0x7087d3c0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @↱2✗zeros_276 parent: [subgraph @2✗zeros_225]() {
  %1(CNode_272) = $(2✗zeros_225):S_Prim_isinstance(%para13_size, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @↱2✗zeros_276:CNode_348{[0]: ValueNode<Primitive> Return, [1]: CNode_272}


subgraph attr:
subgraph instance: _new_prim_for_graph_286 : 0x7089ebc0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:67/    def _new_prim_for_graph(*args, **kwargs) -> Primitive:/
subgraph @_new_prim_for_graph_286 parent: [subgraph @_get_cache_prim_176](%para20_args, %para21_kwargs) {
  %1(CNode_349) = UnpackCall_unpack_call(%para16_cls, %para20_args, %para21_kwargs)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:68/        return cls(*args, **kwargs)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:68/        return cls(*args, **kwargs)/
}
# Order:
#   1: @_new_prim_for_graph_286:CNode_349{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.350, [1]: param_cls, [2]: param_args, [3]: param_kwargs}
#   2: @_new_prim_for_graph_286:CNode_351{[0]: ValueNode<Primitive> Return, [1]: CNode_349}


subgraph attr:
subgraph instance: mean_293 : 0x73b3a2c0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @mean_293(%para22_x, %para23_axis, %para24_keep_dims) {
  %1(CNode_352) = S_Prim_is_(%para23_axis, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %2(CNode_353) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %3(CNode_354) = Switch(%2, @✓mean_355, @✗mean_356)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %4(CNode_357) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %5(CNode_359) = call @↓mean_358(%4)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:107/        avg_probs = ops.mean(encodings, axis=0)/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
}
# Order:
#   1: @mean_293:CNode_352{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_, [1]: param_axis, [2]: ValueNode<None> None}
#   2: @mean_293:CNode_353{[0]: ValueNode<Primitive> Cond, [1]: CNode_352, [2]: ValueNode<BoolImm> false}
#   3: @mean_293:CNode_354{[0]: ValueNode<Primitive> Switch, [1]: CNode_353, [2]: ValueNode<FuncGraph> ✓mean_355, [3]: ValueNode<FuncGraph> ✗mean_356}
#   4: @mean_293:CNode_357{[0]: CNode_354}
#   5: @mean_293:CNode_359{[0]: ValueNode<FuncGraph> ↓mean_358, [1]: CNode_357}
#   6: @mean_293:CNode_360{[0]: ValueNode<Primitive> Return, [1]: CNode_359}


subgraph attr:
subgraph instance: log_295 : 0x73b5ca30
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1432/def log(input):/
subgraph @log_295(%para25_input) {
  %1(CNode_361) = S_Prim_Log[output_names: ["y"], shift: F32(0), scale: F32(1), cust_aicpu: "Log", input_names: ["x"], base: F32(-1)](%para25_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1464/    return log_(input)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1464/    return log_(input)/
}
# Order:
#   1: @log_295:CNode_361{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Log, [1]: param_input}
#   2: @log_295:CNode_362{[0]: ValueNode<Primitive> Return, [1]: CNode_361}


subgraph attr:
subgraph instance: exp_300 : 0x73b01070
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1368/def exp(input):/
subgraph @exp_300(%para26_input) {
  %1(CNode_363) = S_Prim_Exp[output_names: ["y"], shift: F32(0), scale: F32(1), input_names: ["x"], base: F32(-1)](%para26_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1397/    return tensor_exp(input)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1397/    return tensor_exp(input)/
}
# Order:
#   1: @exp_300:CNode_363{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Exp, [1]: param_input}
#   2: @exp_300:CNode_364{[0]: ValueNode<Primitive> Return, [1]: CNode_363}


subgraph attr:
subgraph instance: mse_loss_288 : 0x708c6fe0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @mse_loss_288(%para27_input, %para28_target, %para29_reduction) {
  %1(CNode_365) = S_Prim_MakeTuple(ClassType, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
  %2(CNode_366) = S_Prim_isinstance(%para27_input, %1)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
  %3(CNode_367) = S_Prim_logical_not(%2)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
  %4(CNode_368) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
  %5(CNode_369) = Switch(%4, @✓mse_loss_370, @✗mse_loss_371)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
  %6(CNode_372) = %5()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
  Return(%6)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
}
# Order:
#   1: @mse_loss_288:CNode_365{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor', [2]: ValueNode<ClassType> class 'mindspore._c_expression.Tensor'}
#   2: @mse_loss_288:CNode_366{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_input, [2]: CNode_365}
#   3: @mse_loss_288:CNode_367{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_366}
#   4: @mse_loss_288:CNode_368{[0]: ValueNode<Primitive> Cond, [1]: CNode_367, [2]: ValueNode<BoolImm> false}
#   5: @mse_loss_288:CNode_369{[0]: ValueNode<Primitive> Switch, [1]: CNode_368, [2]: ValueNode<FuncGraph> ✓mse_loss_370, [3]: ValueNode<FuncGraph> ✗mse_loss_371}
#   6: @mse_loss_288:CNode_372{[0]: CNode_369}
#   7: @mse_loss_288:CNode_373{[0]: ValueNode<Primitive> Return, [1]: CNode_372}


subgraph attr:
after_block : 1
subgraph instance: 2↓matmul_307 : 0x706fa200
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @2↓matmul_307 parent: [subgraph @matmul_104]() {
  %1(other) = S_Prim__expand[constexpr_prim: Bool(1)](%para5_other, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9679/    other = _expand(other, 2)/
  %2(CNode_374) = S_Prim_Rank(%1)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %3(CNode_375) = S_Prim_equal(%2, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %4(CNode_376) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %5(CNode_377) = Switch(%4, @✓2↓matmul_378, @✗2↓matmul_379)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %6(CNode_380) = %5()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %7(CNode_382) = call @3↓matmul_381(%6)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
}
# Order:
#   1: @2↓matmul_307:CNode_383{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: param_input}
#   2: @2↓matmul_307:CNode_384{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: param_other}
#   3: @2↓matmul_307:CNode_385{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_383, [2]: CNode_384}
#   4: @2↓matmul_307:ndim1_orig{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_385, [2]: ValueNode<Int64Imm> 0}
#   5: @2↓matmul_307:ndim2_orig{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_385, [2]: ValueNode<Int64Imm> 1}
#   6: @2↓matmul_307:CNode_386{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: param_input}
#   7: @2↓matmul_307:CNode_387{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: param_other}
#   8: @2↓matmul_307:CNode_388{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_386, [2]: CNode_387}
#   9: @2↓matmul_307:shape1_orig{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_388, [2]: ValueNode<Int64Imm> 0}
#  10: @2↓matmul_307:shape2_orig{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_388, [2]: ValueNode<Int64Imm> 1}
#  11: @2↓matmul_307:transpose_b{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: ndim2_orig, [2]: ValueNode<Int64Imm> 1}
#  12: @2↓matmul_307:shape_backbone{[0]: ValueNode<DoSignaturePrimitive> S_Prim__check_matmul_shapes, [1]: shape1_orig, [2]: shape2_orig, [3]: ValueNode<StringImm> matmul}
#  13: @2↓matmul_307:CNode_389{[0]: ValueNode<DoSignaturePrimitive> S_Prim__infer_shape_rem, [1]: shape1_orig, [2]: shape2_orig, [3]: ndim1_orig, [4]: ndim2_orig, [5]: transpose_b}
#  14: @2↓matmul_307:shape_out{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: shape_backbone, [2]: CNode_389}
#  15: @2↓matmul_307:CNode_390{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.MatMul'}
#  16: @2↓matmul_307:_matmul{[0]: CNode_390, [1]: ValueNode<BoolImm> false, [2]: transpose_b}
#  17: @2↓matmul_307:CNode_391{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.BatchMatMul'}
#  18: @2↓matmul_307:_batch_matmul{[0]: CNode_391, [1]: ValueNode<BoolImm> false, [2]: transpose_b}
#  19: @2↓matmul_307:input{[0]: ValueNode<DoSignaturePrimitive> S_Prim__expand, [1]: param_input, [2]: ValueNode<Int64Imm> 2}
#  20: @2↓matmul_307:other{[0]: ValueNode<DoSignaturePrimitive> S_Prim__expand, [1]: param_other, [2]: ValueNode<Int64Imm> 2}
#  21: @2↓matmul_307:CNode_374{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: other}
#  22: @2↓matmul_307:CNode_375{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: CNode_374, [2]: ValueNode<Int64Imm> 2}
#  23: @2↓matmul_307:CNode_376{[0]: ValueNode<Primitive> Cond, [1]: CNode_375, [2]: ValueNode<BoolImm> false}
#  24: @2↓matmul_307:CNode_377{[0]: ValueNode<Primitive> Switch, [1]: CNode_376, [2]: ValueNode<FuncGraph> ✓2↓matmul_378, [3]: ValueNode<FuncGraph> ✗2↓matmul_379}
#  25: @2↓matmul_307:CNode_380{[0]: CNode_377}
#  26: @2↓matmul_307:CNode_382{[0]: ValueNode<FuncGraph> 3↓matmul_381, [1]: CNode_380}
#  27: @2↓matmul_307:CNode_392{[0]: ValueNode<Primitive> Return, [1]: CNode_382}


subgraph attr:
after_block : 1
subgraph instance: 2↓sum_319 : 0x7079b2e0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @2↓sum_319 parent: [subgraph @sum_94]() {
  %1(CNode_393) = S_Prim_isinstance(%para8_keepdim, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  %2(CNode_394) = S_Prim_logical_not(%1)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  %3(CNode_395) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  %4(CNode_396) = Switch(%3, @✓2↓sum_397, @✗2↓sum_398)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  %5(CNode_399) = %4()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
}
# Order:
#   1: @2↓sum_319:CNode_393{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_keepdim, [2]: ValueNode<ClassType> class 'bool'}
#   2: @2↓sum_319:CNode_394{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_393}
#   3: @2↓sum_319:CNode_395{[0]: ValueNode<Primitive> Cond, [1]: CNode_394, [2]: ValueNode<BoolImm> false}
#   4: @2↓sum_319:CNode_396{[0]: ValueNode<Primitive> Switch, [1]: CNode_395, [2]: ValueNode<FuncGraph> ✓2↓sum_397, [3]: ValueNode<FuncGraph> ✗2↓sum_398}
#   5: @2↓sum_319:CNode_399{[0]: CNode_396}
#   6: @2↓sum_319:CNode_400{[0]: ValueNode<Primitive> Return, [1]: CNode_399}


subgraph attr:
after_block : 1
subgraph instance: 2↓argmin_329 : 0x707994c0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @2↓argmin_329 parent: [subgraph @argmin_112](%para30_, %para31_, %para32_) {
  %1(CNode_401) = Cond(%para12_keepdims, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %2(CNode_402) = Switch(%1, @↰2↓argmin_403, @↱2↓argmin_404)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %3(CNode_405) = %2()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %4(CNode_406) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %5(CNode_407) = Switch(%4, @✓2↓argmin_408, @✗2↓argmin_409)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %6(CNode_410) = %5()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %7(CNode_412) = call @3↓argmin_411(%6)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:74/        encoding_indices = ops.argmin(distances, axis=1).unsqueeze(1)/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
}
# Order:
#   1: @2↓argmin_329:CNode_413{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.array_ops.Argmin'}
#   2: @2↓argmin_329:CNode_414{[0]: CNode_413, [1]: param_фaxis}
#   3: @2↓argmin_329:out{[0]: CNode_414, [1]: param_фinput}
#   4: @2↓argmin_329:CNode_401{[0]: ValueNode<Primitive> Cond, [1]: param_keepdims, [2]: ValueNode<BoolImm> false}
#   5: @2↓argmin_329:CNode_402{[0]: ValueNode<Primitive> Switch, [1]: CNode_401, [2]: ValueNode<FuncGraph> ↰2↓argmin_403, [3]: ValueNode<FuncGraph> ↱2↓argmin_404}
#   6: @2↓argmin_329:CNode_405{[0]: CNode_402}
#   7: @2↓argmin_329:CNode_406{[0]: ValueNode<Primitive> Cond, [1]: CNode_405, [2]: ValueNode<BoolImm> false}
#   8: @2↓argmin_329:CNode_407{[0]: ValueNode<Primitive> Switch, [1]: CNode_406, [2]: ValueNode<FuncGraph> ✓2↓argmin_408, [3]: ValueNode<FuncGraph> ✗2↓argmin_409}
#   9: @2↓argmin_329:CNode_410{[0]: CNode_407}
#  10: @2↓argmin_329:CNode_412{[0]: ValueNode<FuncGraph> 3↓argmin_411, [1]: CNode_410}
#  11: @2↓argmin_329:CNode_415{[0]: ValueNode<Primitive> Return, [1]: CNode_412}


subgraph attr:
subgraph instance: 2↰2✗zeros_344 : 0x7087f790
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @2↰2✗zeros_344 parent: [subgraph @zeros_117]() {
  %1(CNode_416) = getattr(%para13_size, "size")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %2(CNode_417) = S_Prim_equal(%1, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  Return(%2)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @2↰2✗zeros_344:CNode_416{[0]: ValueNode<Primitive> getattr, [1]: param_size, [2]: ValueNode<StringImm> size}
#   2: @2↰2✗zeros_344:CNode_417{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: CNode_416, [2]: ValueNode<Int64Imm> 1}
#   3: @2↰2✗zeros_344:CNode_418{[0]: ValueNode<Primitive> Return, [1]: CNode_417}


subgraph attr:
subgraph instance: ↱↰2✗zeros_345 : 0x7087ff70
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @↱↰2✗zeros_345 parent: [subgraph @↰2✗zeros_275]() {
  %1(CNode_340) = $(↰2✗zeros_275):getattr(%para13_size, "ndim")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %2(CNode_341) = $(↰2✗zeros_275):S_Prim_equal(%1, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  Return(%2)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @↱↰2✗zeros_345:CNode_419{[0]: ValueNode<Primitive> Return, [1]: CNode_341}


subgraph attr:
after_block : 1
subgraph instance: ↓mean_358 : 0x706fadf0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @↓mean_358 parent: [subgraph @mean_293](%para33_) {
  %1(CNode_420) = call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
  %2(CNode_421) = %1(%para24_keep_dims)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
  %3(CNode_422) = %2(%para22_x, %para33_фaxis)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
  Return(%3)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
}
# Order:
#   1: @↓mean_358:CNode_420{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.ReduceMean'}
#   2: @↓mean_358:CNode_421{[0]: CNode_420, [1]: param_keep_dims}
#   3: @↓mean_358:CNode_422{[0]: CNode_421, [1]: param_x, [2]: param_фaxis}
#   4: @↓mean_358:CNode_423{[0]: ValueNode<Primitive> Return, [1]: CNode_422}


subgraph attr:
subgraph instance: ✓mean_355 : 0x706f0a30
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @✓mean_355() {
  Return(())
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8442/        axis = ()/
}
# Order:
#   1: @✓mean_355:CNode_424{[0]: ValueNode<Primitive> Return, [1]: ValueNode<ValueTuple> ()}


subgraph attr:
subgraph instance: ✗mean_356 : 0x706aa410
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @✗mean_356 parent: [subgraph @mean_293]() {
  Return(%para23_axis)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
}
# Order:
#   1: @✗mean_356:CNode_425{[0]: ValueNode<Primitive> Return, [1]: param_axis}


subgraph attr:
subgraph instance: ✓mse_loss_370 : 0x708cd9d0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✓mse_loss_370() {
  %1(CNode_426) = raise[side_effect_io: Bool(1)]("TypeError", "For ops.mse_loss, the `input` must be tensor", "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6910/        raise TypeError("For ops.mse_loss, the `input` must be tensor")/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6910/        raise TypeError("For ops.mse_loss, the `input` must be tensor")/
}
# Order:
#   1: @✓mse_loss_370:CNode_426{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: ValueNode<StringImm> For ops.mse_loss, the `input` must be tensor, [3]: ValueNode<StringImm> None}
#   2: @✓mse_loss_370:CNode_427{[0]: ValueNode<Primitive> Return, [1]: CNode_426}


subgraph attr:
subgraph instance: ✗mse_loss_371 : 0x708cde90
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✗mse_loss_371 parent: [subgraph @mse_loss_288]() {
  %1(CNode_429) = call @↓mse_loss_428()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6909/    if not isinstance(input, (Tensor, Tensor_)):/
}
# Order:
#   1: @✗mse_loss_371:CNode_429{[0]: ValueNode<FuncGraph> ↓mse_loss_428}
#   2: @✗mse_loss_371:CNode_430{[0]: ValueNode<Primitive> Return, [1]: CNode_429}


subgraph attr:
after_block : 1
subgraph instance: 3↓matmul_381 : 0x707704f0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @3↓matmul_381 parent: [subgraph @2↓matmul_307](%para34_) {
  %1(CNode_386) = $(2↓matmul_307):S_Prim_Shape(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %2(CNode_387) = $(2↓matmul_307):S_Prim_Shape(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %3(CNode_388) = $(2↓matmul_307):S_Prim_MakeTuple(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %4(shape1_orig) = $(2↓matmul_307):S_Prim_getitem(%3, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %5(shape2_orig) = $(2↓matmul_307):S_Prim_getitem(%3, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %6(shape_backbone) = $(2↓matmul_307):S_Prim__check_matmul_shapes[constexpr_prim: Bool(1)](%4, %5, "matmul")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9670/    shape_backbone = _check_matmul_shapes(shape1_orig, shape2_orig, 'matmul')/
  %7(CNode_383) = $(2↓matmul_307):S_Prim_Rank(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %8(CNode_384) = $(2↓matmul_307):S_Prim_Rank(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %9(CNode_385) = $(2↓matmul_307):S_Prim_MakeTuple(%7, %8)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %10(ndim1_orig) = $(2↓matmul_307):S_Prim_getitem(%9, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %11(ndim2_orig) = $(2↓matmul_307):S_Prim_getitem(%9, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %12(transpose_b) = $(2↓matmul_307):S_Prim_equal(%11, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9669/    transpose_b = ndim2_orig == 1/
  %13(CNode_389) = $(2↓matmul_307):S_Prim__infer_shape_rem[constexpr_prim: Bool(1)](%4, %5, %10, %11, %12)
      : (<null>, <null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9672/    shape_out = shape_backbone + _infer_shape_rem(shape1_orig, shape2_orig,/
  %14(shape_out) = $(2↓matmul_307):S_Prim_add(%6, %13)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9672/    shape_out = shape_backbone + _infer_shape_rem(shape1_orig, shape2_orig,/
  %15(CNode_431) = S_Prim_Reshape[output_names: ["output"], input_names: ["tensor", "shape"]](%para34_фres, %14)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9694/    return reshape_(res, shape_out)/
  Return(%15)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9694/    return reshape_(res, shape_out)/
}
# Order:
#   1: @3↓matmul_381:CNode_431{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Reshape, [1]: param_фres, [2]: shape_out}
#   2: @3↓matmul_381:CNode_432{[0]: ValueNode<Primitive> Return, [1]: CNode_431}


subgraph attr:
subgraph instance: ✓2↓matmul_378 : 0x707364b0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @✓2↓matmul_378 parent: [subgraph @2↓matmul_307]() {
  %1(input) = $(2↓matmul_307):S_Prim__expand[constexpr_prim: Bool(1)](%para4_input, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9678/    input = _expand(input, 2)/
  %2(CNode_433) = S_Prim_Rank(%1)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %3(CNode_434) = S_Prim_greater(%2, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %4(CNode_435) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %5(CNode_436) = Switch(%4, @2✓2↓matmul_437, @✗✓2↓matmul_438)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %6(CNode_439) = %5()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %7(CNode_441) = call @↓✓2↓matmul_440(%6)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:71/                     - 2 * ops.matmul(flat_input, self._embedding_weights.t()))/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
}
# Order:
#   1: @✓2↓matmul_378:CNode_433{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: input}
#   2: @✓2↓matmul_378:CNode_434{[0]: ValueNode<DoSignaturePrimitive> S_Prim_greater, [1]: CNode_433, [2]: ValueNode<Int64Imm> 2}
#   3: @✓2↓matmul_378:CNode_435{[0]: ValueNode<Primitive> Cond, [1]: CNode_434, [2]: ValueNode<BoolImm> false}
#   4: @✓2↓matmul_378:CNode_436{[0]: ValueNode<Primitive> Switch, [1]: CNode_435, [2]: ValueNode<FuncGraph> 2✓2↓matmul_437, [3]: ValueNode<FuncGraph> ✗✓2↓matmul_438}
#   5: @✓2↓matmul_378:CNode_439{[0]: CNode_436}
#   6: @✓2↓matmul_378:CNode_441{[0]: ValueNode<FuncGraph> ↓✓2↓matmul_440, [1]: CNode_439}
#   7: @✓2↓matmul_378:CNode_442{[0]: ValueNode<Primitive> Return, [1]: CNode_441}


subgraph attr:
subgraph instance: ✗2↓matmul_379 : 0x70727820
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @✗2↓matmul_379 parent: [subgraph @2↓matmul_307]() {
  %1(CNode_391) = $(2↓matmul_307):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9676/    _batch_matmul = _get_cache_prim(P.BatchMatMul)(False, transpose_b)/
  %2(CNode_383) = $(2↓matmul_307):S_Prim_Rank(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %3(CNode_384) = $(2↓matmul_307):S_Prim_Rank(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %4(CNode_385) = $(2↓matmul_307):S_Prim_MakeTuple(%2, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %5(ndim2_orig) = $(2↓matmul_307):S_Prim_getitem(%4, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %6(transpose_b) = $(2↓matmul_307):S_Prim_equal(%5, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9669/    transpose_b = ndim2_orig == 1/
  %7(_batch_matmul) = $(2↓matmul_307):%1(Bool(0), %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9676/    _batch_matmul = _get_cache_prim(P.BatchMatMul)(False, transpose_b)/
  %8(input) = $(2↓matmul_307):S_Prim__expand[constexpr_prim: Bool(1)](%para4_input, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9678/    input = _expand(input, 2)/
  %9(ndim1_orig) = $(2↓matmul_307):S_Prim_getitem(%4, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %10(ndim_aligned) = S_Prim__max[constexpr_prim: Bool(1)](%9, %5)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9686/        ndim_aligned = _max(ndim1_orig, ndim2_orig)/
  %11(input) = S_Prim__expand[constexpr_prim: Bool(1)](%8, %10)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9687/        input = _expand(input, ndim_aligned)/
  %12(CNode_443) = S_Prim_Shape(%11)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %13(other) = $(2↓matmul_307):S_Prim__expand[constexpr_prim: Bool(1)](%para5_other, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9679/    other = _expand(other, 2)/
  %14(other) = S_Prim__expand[constexpr_prim: Bool(1)](%13, %10)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9688/        other = _expand(other, ndim_aligned)/
  %15(CNode_444) = S_Prim_Shape(%14)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %16(CNode_445) = S_Prim_MakeTuple(%12, %15)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %17(shape1_aligned) = S_Prim_getitem(%16, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %18(CNode_446) = S_Prim_negative(I64(2))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9690/        input = _broadcast_to(input, shape1_aligned[:-2], shape_backbone, ndim_aligned)/
  %19(CNode_447) = S_Prim_make_slice(None, %18, None)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9690/        input = _broadcast_to(input, shape1_aligned[:-2], shape_backbone, ndim_aligned)/
  %20(CNode_448) = S_Prim_getitem(%17, %19)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9690/        input = _broadcast_to(input, shape1_aligned[:-2], shape_backbone, ndim_aligned)/
  %21(CNode_386) = $(2↓matmul_307):S_Prim_Shape(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %22(CNode_387) = $(2↓matmul_307):S_Prim_Shape(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %23(CNode_388) = $(2↓matmul_307):S_Prim_MakeTuple(%21, %22)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %24(shape1_orig) = $(2↓matmul_307):S_Prim_getitem(%23, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %25(shape2_orig) = $(2↓matmul_307):S_Prim_getitem(%23, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %26(shape_backbone) = $(2↓matmul_307):S_Prim__check_matmul_shapes[constexpr_prim: Bool(1)](%24, %25, "matmul")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9670/    shape_backbone = _check_matmul_shapes(shape1_orig, shape2_orig, 'matmul')/
  %27(input) = call @_broadcast_to_449(%11, %20, %26, %10)
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9690/        input = _broadcast_to(input, shape1_aligned[:-2], shape_backbone, ndim_aligned)/
  %28(shape2_aligned) = S_Prim_getitem(%16, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %29(CNode_450) = S_Prim_negative(I64(2))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9691/        other = _broadcast_to(other, shape2_aligned[:-2], shape_backbone, ndim_aligned)/
  %30(CNode_451) = S_Prim_make_slice(None, %29, None)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9691/        other = _broadcast_to(other, shape2_aligned[:-2], shape_backbone, ndim_aligned)/
  %31(CNode_452) = S_Prim_getitem(%28, %30)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9691/        other = _broadcast_to(other, shape2_aligned[:-2], shape_backbone, ndim_aligned)/
  %32(other) = call @_broadcast_to_449(%14, %31, %26, %10)
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9691/        other = _broadcast_to(other, shape2_aligned[:-2], shape_backbone, ndim_aligned)/
  %33(res) = %7(%27, %32)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9692/        res = _batch_matmul(input, other)/
  Return(%33)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9686/        ndim_aligned = _max(ndim1_orig, ndim2_orig)/
}
# Order:
#   1: @✗2↓matmul_379:ndim_aligned{[0]: ValueNode<DoSignaturePrimitive> S_Prim__max, [1]: ndim1_orig, [2]: ndim2_orig}
#   2: @✗2↓matmul_379:input{[0]: ValueNode<DoSignaturePrimitive> S_Prim__expand, [1]: input, [2]: ndim_aligned}
#   3: @✗2↓matmul_379:other{[0]: ValueNode<DoSignaturePrimitive> S_Prim__expand, [1]: other, [2]: ndim_aligned}
#   4: @✗2↓matmul_379:CNode_443{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: input}
#   5: @✗2↓matmul_379:CNode_444{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: other}
#   6: @✗2↓matmul_379:CNode_445{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_443, [2]: CNode_444}
#   7: @✗2↓matmul_379:shape1_aligned{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_445, [2]: ValueNode<Int64Imm> 0}
#   8: @✗2↓matmul_379:shape2_aligned{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_445, [2]: ValueNode<Int64Imm> 1}
#   9: @✗2↓matmul_379:CNode_446{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 2}
#  10: @✗2↓matmul_379:CNode_447{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_slice, [1]: ValueNode<None> None, [2]: CNode_446, [3]: ValueNode<None> None}
#  11: @✗2↓matmul_379:CNode_448{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: shape1_aligned, [2]: CNode_447}
#  12: @✗2↓matmul_379:input{[0]: ValueNode<FuncGraph> _broadcast_to_449, [1]: input, [2]: CNode_448, [3]: shape_backbone, [4]: ndim_aligned}
#  13: @✗2↓matmul_379:CNode_450{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 2}
#  14: @✗2↓matmul_379:CNode_451{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_slice, [1]: ValueNode<None> None, [2]: CNode_450, [3]: ValueNode<None> None}
#  15: @✗2↓matmul_379:CNode_452{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: shape2_aligned, [2]: CNode_451}
#  16: @✗2↓matmul_379:other{[0]: ValueNode<FuncGraph> _broadcast_to_449, [1]: other, [2]: CNode_452, [3]: shape_backbone, [4]: ndim_aligned}
#  17: @✗2↓matmul_379:res{[0]: _batch_matmul, [1]: input, [2]: other}
#  18: @✗2↓matmul_379:CNode_453{[0]: ValueNode<Primitive> Return, [1]: res}


subgraph attr:
subgraph instance: ✓2↓sum_397 : 0x706dcc50
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✓2↓sum_397 parent: [subgraph @sum_94]() {
  %1(CNode_454) = S_Prim_MakeTuple("keepdim")
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  %2(CNode_455) = S_Prim_MakeTuple(%para8_keepdim)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  %3(CNode_456) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  %4(CNode_457) = PyInterpret[side_effect_io: Bool(1)](Script['f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}"'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  %5(CNode_458) = raise[side_effect_io: Bool(1)]("TypeError", %4, "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
}
# Order:
#   1: @✓2↓sum_397:CNode_454{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> keepdim}
#   2: @✓2↓sum_397:CNode_455{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_keepdim}
#   3: @✓2↓sum_397:CNode_456{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_454, [2]: CNode_455}
#   4: @✓2↓sum_397:CNode_457{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}"', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'isinstance': <built-in function isinstance>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>, 'type': <class 'type'>, 'int': <class 'int'>, 'tuple': <class 'tuple'>, 'list': <class 'list'>, 'bool': <class 'bool'>}), [3]: CNode_456}
#   5: @✓2↓sum_397:CNode_458{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: CNode_457, [3]: ValueNode<StringImm> None}
#   6: @✓2↓sum_397:CNode_459{[0]: ValueNode<Primitive> Return, [1]: CNode_458}


subgraph attr:
subgraph instance: ✗2↓sum_398 : 0x73b73ad0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✗2↓sum_398 parent: [subgraph @sum_94]() {
  %1(CNode_461) = call @3↓sum_460()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
}
# Order:
#   1: @✗2↓sum_398:CNode_461{[0]: ValueNode<FuncGraph> 3↓sum_460}
#   2: @✗2↓sum_398:CNode_462{[0]: ValueNode<Primitive> Return, [1]: CNode_461}


subgraph attr:
after_block : 1
subgraph instance: 3↓argmin_411 : 0x707856f0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @3↓argmin_411(%para35_) {
  Return(%para35_фout)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:673/    return out/
}
# Order:
#   1: @3↓argmin_411:CNode_463{[0]: ValueNode<Primitive> Return, [1]: param_фout}


subgraph attr:
subgraph instance: ✓2↓argmin_408 : 0x70784ae0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @✓2↓argmin_408 parent: [subgraph @2↓argmin_329]() {
  %1(CNode_413) = $(2↓argmin_329):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %2(CNode_414) = $(2↓argmin_329):%1(%para30_фaxis)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %3(out) = $(2↓argmin_329):%2(%para31_фinput)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %4(out) = S_Prim_ExpandDims[output_names: ["output"], input_names: ["x", "axis"]](%3, %para30_фaxis)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:672/        out = expand_dims_(out, axis)/
  Return(%4)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:672/        out = expand_dims_(out, axis)/
}
# Order:
#   1: @✓2↓argmin_408:out{[0]: ValueNode<DoSignaturePrimitive> S_Prim_ExpandDims, [1]: out, [2]: param_фaxis}
#   2: @✓2↓argmin_408:CNode_464{[0]: ValueNode<Primitive> Return, [1]: out}


subgraph attr:
subgraph instance: ✗2↓argmin_409 : 0x70784fa0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @✗2↓argmin_409 parent: [subgraph @2↓argmin_329]() {
  %1(CNode_413) = $(2↓argmin_329):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %2(CNode_414) = $(2↓argmin_329):%1(%para30_фaxis)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %3(out) = $(2↓argmin_329):%2(%para31_фinput)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  Return(%3)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
}
# Order:
#   1: @✗2↓argmin_409:CNode_465{[0]: ValueNode<Primitive> Return, [1]: out}


subgraph attr:
subgraph instance: ↰2↓argmin_403 : 0x706fb890
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @↰2↓argmin_403 parent: [subgraph @2↓argmin_329]() {
  %1(CNode_466) = S_Prim_logical_not(%para32_фis_axis_none)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
}
# Order:
#   1: @↰2↓argmin_403:CNode_466{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: param_фis_axis_none}
#   2: @↰2↓argmin_403:CNode_467{[0]: ValueNode<Primitive> Return, [1]: CNode_466}


subgraph attr:
subgraph instance: ↱2↓argmin_404 : 0x73b25310
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @↱2↓argmin_404 parent: [subgraph @argmin_112]() {
  Return(%para12_keepdims)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
}
# Order:
#   1: @↱2↓argmin_404:CNode_468{[0]: ValueNode<Primitive> Return, [1]: param_keepdims}


subgraph attr:
after_block : 1
subgraph instance: ↓mse_loss_428 : 0x708ce350
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @↓mse_loss_428 parent: [subgraph @mse_loss_288]() {
  %1(CNode_469) = S_Prim_MakeTuple(ClassType, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
  %2(CNode_470) = S_Prim_isinstance(%para28_target, %1)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
  %3(CNode_471) = S_Prim_logical_not(%2)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
  %4(CNode_472) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
  %5(CNode_473) = Switch(%4, @✓↓mse_loss_474, @✗↓mse_loss_475)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
  %6(CNode_476) = %5()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
  Return(%6)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
}
# Order:
#   1: @↓mse_loss_428:CNode_469{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor', [2]: ValueNode<ClassType> class 'mindspore._c_expression.Tensor'}
#   2: @↓mse_loss_428:CNode_470{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_target, [2]: CNode_469}
#   3: @↓mse_loss_428:CNode_471{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_470}
#   4: @↓mse_loss_428:CNode_472{[0]: ValueNode<Primitive> Cond, [1]: CNode_471, [2]: ValueNode<BoolImm> false}
#   5: @↓mse_loss_428:CNode_473{[0]: ValueNode<Primitive> Switch, [1]: CNode_472, [2]: ValueNode<FuncGraph> ✓↓mse_loss_474, [3]: ValueNode<FuncGraph> ✗↓mse_loss_475}
#   6: @↓mse_loss_428:CNode_476{[0]: CNode_473}
#   7: @↓mse_loss_428:CNode_477{[0]: ValueNode<Primitive> Return, [1]: CNode_476}


subgraph attr:
after_block : 1
subgraph instance: ↓✓2↓matmul_440 : 0x70735710
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @↓✓2↓matmul_440 parent: [subgraph @2↓matmul_307](%para36_) {
  %1(CNode_390) = $(2↓matmul_307):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9675/    _matmul = _get_cache_prim(P.MatMul)(False, transpose_b)/
  %2(CNode_383) = $(2↓matmul_307):S_Prim_Rank(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %3(CNode_384) = $(2↓matmul_307):S_Prim_Rank(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %4(CNode_385) = $(2↓matmul_307):S_Prim_MakeTuple(%2, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %5(ndim2_orig) = $(2↓matmul_307):S_Prim_getitem(%4, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %6(transpose_b) = $(2↓matmul_307):S_Prim_equal(%5, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9669/    transpose_b = ndim2_orig == 1/
  %7(_matmul) = $(2↓matmul_307):%1(Bool(0), %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9675/    _matmul = _get_cache_prim(P.MatMul)(False, transpose_b)/
  %8(other) = $(2↓matmul_307):S_Prim__expand[constexpr_prim: Bool(1)](%para5_other, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9679/    other = _expand(other, 2)/
  %9(res) = %7(%para36_фinput, %8)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9683/        res = _matmul(input, other)/
  Return(%9)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
}
# Order:
#   1: @↓✓2↓matmul_440:res{[0]: _matmul, [1]: param_фinput, [2]: other}
#   2: @↓✓2↓matmul_440:CNode_478{[0]: ValueNode<Primitive> Return, [1]: res}


subgraph attr:
subgraph instance: 2✓2↓matmul_437 : 0x707370f0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @2✓2↓matmul_437 parent: [subgraph @2↓matmul_307]() {
  %1(input) = $(2↓matmul_307):S_Prim__expand[constexpr_prim: Bool(1)](%para4_input, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9678/    input = _expand(input, 2)/
  %2(CNode_479) = S_Prim_negative(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  %3(CNode_386) = $(2↓matmul_307):S_Prim_Shape(%para4_input)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %4(CNode_387) = $(2↓matmul_307):S_Prim_Shape(%para5_other)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %5(CNode_388) = $(2↓matmul_307):S_Prim_MakeTuple(%3, %4)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %6(shape1_orig) = $(2↓matmul_307):S_Prim_getitem(%5, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %7(CNode_480) = S_Prim_negative(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  %8(CNode_481) = S_Prim_getitem(%6, %7)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  %9(CNode_482) = S_Prim_MakeTuple(%2, %8)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  %10(input) = S_Prim_Reshape[output_names: ["output"], input_names: ["tensor", "shape"]](%1, %9)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  Return(%10)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
}
# Order:
#   1: @2✓2↓matmul_437:CNode_479{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 1}
#   2: @2✓2↓matmul_437:CNode_480{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 1}
#   3: @2✓2↓matmul_437:CNode_481{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: shape1_orig, [2]: CNode_480}
#   4: @2✓2↓matmul_437:CNode_482{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_479, [2]: CNode_481}
#   5: @2✓2↓matmul_437:input{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Reshape, [1]: input, [2]: CNode_482}
#   6: @2✓2↓matmul_437:CNode_483{[0]: ValueNode<Primitive> Return, [1]: input}


subgraph attr:
subgraph instance: ✗✓2↓matmul_438 : 0x7078c530
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @✗✓2↓matmul_438 parent: [subgraph @2↓matmul_307]() {
  %1(input) = $(2↓matmul_307):S_Prim__expand[constexpr_prim: Bool(1)](%para4_input, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9678/    input = _expand(input, 2)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
}
# Order:
#   1: @✗✓2↓matmul_438:CNode_484{[0]: ValueNode<Primitive> Return, [1]: input}


subgraph attr:
subgraph instance: _broadcast_to_449 : 0x75e9d490
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9593/def _broadcast_to(x, shape_cur, shape_to, ndim_to):/
subgraph @_broadcast_to_449(%para37_x, %para38_shape_cur, %para39_shape_to, %para40_ndim_to) {
  %1(CNode_485) = call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9595/    tile_size_op = _get_cache_prim(TileSize)()/
  %2(tile_size_op) = %1()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9595/    tile_size_op = _get_cache_prim(TileSize)()/
  %3(size) = %2(%para38_shape_cur, %para39_shape_to, %para40_ndim_to)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9596/    size = tile_size_op(shape_cur, shape_to, ndim_to)/
  %4(CNode_487) = call @stop_gradient_486(%3)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9597/    F.stop_gradient(size)/
  %5(CNode_488) = StopGradient(%4)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9593/def _broadcast_to(x, shape_cur, shape_to, ndim_to):/
  %6(CNode_489) = S_Prim_Tile[output_names: ["output"], input_names: ["x", "multiples"]](%para37_x, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9598/    return tile_(x, size)/
  %7(CNode_490) = Depend[side_effect_propagate: I64(1)](%6, %5)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9598/    return tile_(x, size)/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9598/    return tile_(x, size)/
}
# Order:
#   1: @_broadcast_to_449:CNode_485{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations._inner_ops.TileSize'}
#   2: @_broadcast_to_449:tile_size_op{[0]: CNode_485}
#   3: @_broadcast_to_449:size{[0]: tile_size_op, [1]: param_shape_cur, [2]: param_shape_to, [3]: param_ndim_to}
#   4: @_broadcast_to_449:CNode_487{[0]: ValueNode<FuncGraph> stop_gradient_486, [1]: size}
#   5: @_broadcast_to_449:CNode_489{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Tile, [1]: param_x, [2]: size}
#   6: @_broadcast_to_449:CNode_491{[0]: ValueNode<Primitive> Return, [1]: CNode_490}


subgraph attr:
after_block : 1
subgraph instance: 3↓sum_460 : 0x73b73f90
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @3↓sum_460 parent: [subgraph @sum_94]() {
  %1(CNode_492) = getattr(%para6_input, "dtype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %2(CNode_493) = S_Prim_equal(%1, Bool)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %3(CNode_494) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %4(CNode_495) = Switch(%3, @✓3↓sum_496, @✗3↓sum_497)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %5(CNode_498) = %4()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %6(CNode_500) = call @4↓sum_499(%5)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  Return(%6)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
}
# Order:
#   1: @3↓sum_460:CNode_492{[0]: ValueNode<Primitive> getattr, [1]: param_input, [2]: ValueNode<StringImm> dtype}
#   2: @3↓sum_460:CNode_493{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: CNode_492, [2]: ValueNode<Bool> Bool}
#   3: @3↓sum_460:CNode_494{[0]: ValueNode<Primitive> Cond, [1]: CNode_493, [2]: ValueNode<BoolImm> false}
#   4: @3↓sum_460:CNode_495{[0]: ValueNode<Primitive> Switch, [1]: CNode_494, [2]: ValueNode<FuncGraph> ✓3↓sum_496, [3]: ValueNode<FuncGraph> ✗3↓sum_497}
#   5: @3↓sum_460:CNode_498{[0]: CNode_495}
#   6: @3↓sum_460:CNode_500{[0]: ValueNode<FuncGraph> 4↓sum_499, [1]: CNode_498}
#   7: @3↓sum_460:CNode_501{[0]: ValueNode<Primitive> Return, [1]: CNode_500}


subgraph attr:
subgraph instance: ✓↓mse_loss_474 : 0x708d5070
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✓↓mse_loss_474() {
  %1(CNode_502) = raise[side_effect_io: Bool(1)]("TypeError", "For ops.mse_loss, the `target` must be tensor", "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6912/        raise TypeError("For ops.mse_loss, the `target` must be tensor")/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6912/        raise TypeError("For ops.mse_loss, the `target` must be tensor")/
}
# Order:
#   1: @✓↓mse_loss_474:CNode_502{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: ValueNode<StringImm> For ops.mse_loss, the `target` must be tensor, [3]: ValueNode<StringImm> None}
#   2: @✓↓mse_loss_474:CNode_503{[0]: ValueNode<Primitive> Return, [1]: CNode_502}


subgraph attr:
subgraph instance: ✗↓mse_loss_475 : 0x708d5650
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✗↓mse_loss_475 parent: [subgraph @mse_loss_288]() {
  %1(CNode_505) = call @2↓mse_loss_504()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6911/    if not isinstance(target, (Tensor, Tensor_)):/
}
# Order:
#   1: @✗↓mse_loss_475:CNode_505{[0]: ValueNode<FuncGraph> 2↓mse_loss_504}
#   2: @✗↓mse_loss_475:CNode_506{[0]: ValueNode<Primitive> Return, [1]: CNode_505}


subgraph attr:
subgraph instance: stop_gradient_486 : 0x75eb3290
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/grad/grad_func.py:1367/def stop_gradient(value):/
subgraph @stop_gradient_486(%para41_value) {
  %1(CNode_507) = ClassType()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/grad/grad_func.py:1401/    return P.StopGradient()(value)/
  %2(CNode_508) = %1(%para41_value)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/grad/grad_func.py:1401/    return P.StopGradient()(value)/
  Return(%2)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/grad/grad_func.py:1401/    return P.StopGradient()(value)/
}
# Order:
#   1: @stop_gradient_486:CNode_507{[0]: ValueNode<ClassType> class 'mindspore.ops.operations.other_ops.StopGradient'}
#   2: @stop_gradient_486:CNode_508{[0]: CNode_507, [1]: param_value}
#   3: @stop_gradient_486:CNode_509{[0]: ValueNode<Primitive> Return, [1]: CNode_508}


subgraph attr:
after_block : 1
subgraph instance: 4↓sum_499 : 0x706c6550
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @4↓sum_499 parent: [subgraph @sum_94](%para42_) {
  %1(CNode_510) = S_Prim_is_not(%para9_dtype, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
  %2(CNode_511) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
  %3(CNode_512) = Switch(%2, @✓4↓sum_513, @✗4↓sum_514)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
  %4(CNode_515) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
  %5(CNode_517) = call @5↓sum_516(%4)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
}
# Order:
#   1: @4↓sum_499:CNode_510{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_not, [1]: param_dtype, [2]: ValueNode<None> None}
#   2: @4↓sum_499:CNode_511{[0]: ValueNode<Primitive> Cond, [1]: CNode_510, [2]: ValueNode<BoolImm> false}
#   3: @4↓sum_499:CNode_512{[0]: ValueNode<Primitive> Switch, [1]: CNode_511, [2]: ValueNode<FuncGraph> ✓4↓sum_513, [3]: ValueNode<FuncGraph> ✗4↓sum_514}
#   4: @4↓sum_499:CNode_515{[0]: CNode_512}
#   5: @4↓sum_499:CNode_517{[0]: ValueNode<FuncGraph> 5↓sum_516, [1]: CNode_515}
#   6: @4↓sum_499:CNode_518{[0]: ValueNode<Primitive> Return, [1]: CNode_517}


subgraph attr:
subgraph instance: ✓3↓sum_496 : 0x706a2e40
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✓3↓sum_496 parent: [subgraph @sum_94]() {
  %1(CNode_519) = getattr(%para6_input, "astype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12018/        input = input.astype(mstype.int64)/
  %2(input) = %1(I64)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12018/        input = input.astype(mstype.int64)/
  Return(%2)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12018/        input = input.astype(mstype.int64)/
}
# Order:
#   1: @✓3↓sum_496:CNode_519{[0]: ValueNode<Primitive> getattr, [1]: param_input, [2]: ValueNode<StringImm> astype}
#   2: @✓3↓sum_496:input{[0]: CNode_519, [1]: ValueNode<Int> Int64}
#   3: @✓3↓sum_496:CNode_520{[0]: ValueNode<Primitive> Return, [1]: input}


subgraph attr:
subgraph instance: ✗3↓sum_497 : 0x706a3300
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✗3↓sum_497 parent: [subgraph @sum_94]() {
  Return(%para6_input)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
}
# Order:
#   1: @✗3↓sum_497:CNode_521{[0]: ValueNode<Primitive> Return, [1]: param_input}


subgraph attr:
after_block : 1
subgraph instance: 2↓mse_loss_504 : 0x708d5ba0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @2↓mse_loss_504 parent: [subgraph @mse_loss_288]() {
  %1(CNode_522) = S_Prim_make_list("mean", "none", "sum")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6913/    if reduction not in ['mean', 'none', 'sum']:/
  %2(CNode_523) = S_Prim_not_in(%para29_reduction, %1)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6913/    if reduction not in ['mean', 'none', 'sum']:/
  %3(CNode_524) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6913/    if reduction not in ['mean', 'none', 'sum']:/
  %4(CNode_525) = Switch(%3, @✓2↓mse_loss_526, @✗2↓mse_loss_527)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6913/    if reduction not in ['mean', 'none', 'sum']:/
  %5(CNode_528) = %4()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6913/    if reduction not in ['mean', 'none', 'sum']:/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6913/    if reduction not in ['mean', 'none', 'sum']:/
}
# Order:
#   1: @2↓mse_loss_504:CNode_522{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_list, [1]: ValueNode<StringImm> mean, [2]: ValueNode<StringImm> none, [3]: ValueNode<StringImm> sum}
#   2: @2↓mse_loss_504:CNode_523{[0]: ValueNode<DoSignaturePrimitive> S_Prim_not_in, [1]: param_reduction, [2]: CNode_522}
#   3: @2↓mse_loss_504:CNode_524{[0]: ValueNode<Primitive> Cond, [1]: CNode_523, [2]: ValueNode<BoolImm> false}
#   4: @2↓mse_loss_504:CNode_525{[0]: ValueNode<Primitive> Switch, [1]: CNode_524, [2]: ValueNode<FuncGraph> ✓2↓mse_loss_526, [3]: ValueNode<FuncGraph> ✗2↓mse_loss_527}
#   5: @2↓mse_loss_504:CNode_528{[0]: CNode_525}
#   6: @2↓mse_loss_504:CNode_529{[0]: ValueNode<Primitive> Return, [1]: CNode_528}


subgraph attr:
after_block : 1
subgraph instance: 5↓sum_516 : 0x73b44c00
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @5↓sum_516 parent: [subgraph @sum_94](%para43_) {
  %1(CNode_530) = S_Prim_is_not(%para7_dim, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
  %2(CNode_531) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
  %3(CNode_532) = Switch(%2, @✓5↓sum_533, @✗5↓sum_534)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
  %4(CNode_535) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
  %5(CNode_537) = call @6↓sum_536(%4)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:70/                     + ops.sum(self._embedding_weights ** 2, dim=1)/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
}
# Order:
#   1: @5↓sum_516:CNode_538{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.ReduceSum'}
#   2: @5↓sum_516:CNode_539{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> keep_dims}
#   3: @5↓sum_516:CNode_540{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_keepdim}
#   4: @5↓sum_516:CNode_541{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_539, [2]: CNode_540}
#   5: @5↓sum_516:reduce_sum{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.542, [1]: CNode_538, [2]: CNode_541}
#   6: @5↓sum_516:CNode_530{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_not, [1]: param_dim, [2]: ValueNode<None> None}
#   7: @5↓sum_516:CNode_531{[0]: ValueNode<Primitive> Cond, [1]: CNode_530, [2]: ValueNode<BoolImm> false}
#   8: @5↓sum_516:CNode_532{[0]: ValueNode<Primitive> Switch, [1]: CNode_531, [2]: ValueNode<FuncGraph> ✓5↓sum_533, [3]: ValueNode<FuncGraph> ✗5↓sum_534}
#   9: @5↓sum_516:CNode_535{[0]: CNode_532}
#  10: @5↓sum_516:CNode_537{[0]: ValueNode<FuncGraph> 6↓sum_536, [1]: CNode_535}
#  11: @5↓sum_516:CNode_543{[0]: ValueNode<Primitive> Return, [1]: CNode_537}


subgraph attr:
subgraph instance: ✓4↓sum_513 : 0x70742f10
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✓4↓sum_513 parent: [subgraph @4↓sum_499]() {
  %1(CNode_544) = getattr(%para42_фinput, "astype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12020/        input = input.astype(dtype)/
  %2(input) = %1(%para9_dtype)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12020/        input = input.astype(dtype)/
  Return(%2)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12020/        input = input.astype(dtype)/
}
# Order:
#   1: @✓4↓sum_513:CNode_544{[0]: ValueNode<Primitive> getattr, [1]: param_фinput, [2]: ValueNode<StringImm> astype}
#   2: @✓4↓sum_513:input{[0]: CNode_544, [1]: param_dtype}
#   3: @✓4↓sum_513:CNode_545{[0]: ValueNode<Primitive> Return, [1]: input}


subgraph attr:
subgraph instance: ✗4↓sum_514 : 0x70743660
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✗4↓sum_514 parent: [subgraph @4↓sum_499]() {
  Return(%para42_фinput)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
}
# Order:
#   1: @✗4↓sum_514:CNode_546{[0]: ValueNode<Primitive> Return, [1]: param_фinput}


subgraph attr:
subgraph instance: ✓2↓mse_loss_526 : 0x708dbf90
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✓2↓mse_loss_526() {
  %1(CNode_547) = raise[side_effect_io: Bool(1)]("ValueError", "For ops.mse_loss, `reduction` value should be either 'mean', 'none' or 'sum'.", "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6914/        raise ValueError("For ops.mse_loss, `reduction` value should be either 'mean', 'none' or 'sum'.")/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6914/        raise ValueError("For ops.mse_loss, `reduction` value should be either 'mean', 'none' or 'sum'.")/
}
# Order:
#   1: @✓2↓mse_loss_526:CNode_547{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> ValueError, [2]: ValueNode<StringImm> For ops.mse_loss, `reduction` value should be either 'mean', 'none' or 'sum'., [3]: ValueNode<StringImm> None}
#   2: @✓2↓mse_loss_526:CNode_548{[0]: ValueNode<Primitive> Return, [1]: CNode_547}


subgraph attr:
subgraph instance: ✗2↓mse_loss_527 : 0x708dc6e0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✗2↓mse_loss_527 parent: [subgraph @mse_loss_288]() {
  %1(CNode_550) = call @3↓mse_loss_549()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6913/    if reduction not in ['mean', 'none', 'sum']:/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6913/    if reduction not in ['mean', 'none', 'sum']:/
}
# Order:
#   1: @✗2↓mse_loss_527:CNode_550{[0]: ValueNode<FuncGraph> 3↓mse_loss_549}
#   2: @✗2↓mse_loss_527:CNode_551{[0]: ValueNode<Primitive> Return, [1]: CNode_550}


subgraph attr:
after_block : 1
subgraph instance: 6↓sum_536 : 0x7075c2f0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @6↓sum_536(%para44_) {
  Return(%para44_фout)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12026/    return out/
}
# Order:
#   1: @6↓sum_536:CNode_552{[0]: ValueNode<Primitive> Return, [1]: param_фout}


subgraph attr:
subgraph instance: ✓5↓sum_533 : 0x706a0f80
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✓5↓sum_533 parent: [subgraph @5↓sum_516]() {
  %1(CNode_538) = $(5↓sum_516):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %2(CNode_539) = $(5↓sum_516):S_Prim_MakeTuple("keep_dims")
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %3(CNode_540) = $(5↓sum_516):S_Prim_MakeTuple(%para8_keepdim)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %4(CNode_541) = $(5↓sum_516):S_Prim_make_dict(%2, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %5(reduce_sum) = $(5↓sum_516):UnpackCall_unpack_call(%1, %4)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %6(out) = %5(%para43_фinput, %para7_dim)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12023/        out = reduce_sum(input, dim)/
  Return(%6)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12023/        out = reduce_sum(input, dim)/
}
# Order:
#   1: @✓5↓sum_533:out{[0]: reduce_sum, [1]: param_фinput, [2]: param_dim}
#   2: @✓5↓sum_533:CNode_553{[0]: ValueNode<Primitive> Return, [1]: out}


subgraph attr:
subgraph instance: ✗5↓sum_534 : 0x7075bba0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @✗5↓sum_534 parent: [subgraph @5↓sum_516]() {
  %1(CNode_538) = $(5↓sum_516):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %2(CNode_539) = $(5↓sum_516):S_Prim_MakeTuple("keep_dims")
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %3(CNode_540) = $(5↓sum_516):S_Prim_MakeTuple(%para8_keepdim)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %4(CNode_541) = $(5↓sum_516):S_Prim_make_dict(%2, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %5(reduce_sum) = $(5↓sum_516):UnpackCall_unpack_call(%1, %4)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %6(out) = %5(%para43_фinput)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12025/        out = reduce_sum(input)/
  Return(%6)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12025/        out = reduce_sum(input)/
}
# Order:
#   1: @✗5↓sum_534:out{[0]: reduce_sum, [1]: param_фinput}
#   2: @✗5↓sum_534:CNode_554{[0]: ValueNode<Primitive> Return, [1]: out}


subgraph attr:
after_block : 1
subgraph instance: 3↓mse_loss_549 : 0x7080c830
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @3↓mse_loss_549 parent: [subgraph @mse_loss_288]() {
  %1(CNode_555) = call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %2(CNode_556) = %1()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %3(CNode_557) = S_Prim_sub(%para27_input, %para28_target)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %4(x) = %2(%3)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %5(CNode_558) = getattr(%4, "dtype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6918/    if x.dtype not in float_type:/
  %6(float_type) = S_Prim_MakeTuple(F16, F32, F64)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6917/    float_type = (mstype.float16, mstype.float32, mstype.float64)/
  %7(CNode_559) = S_Prim_not_in(%5, %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6918/    if x.dtype not in float_type:/
  %8(CNode_560) = Cond(%7, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6918/    if x.dtype not in float_type:/
  %9(CNode_561) = Switch(%8, @✓3↓mse_loss_562, @✗3↓mse_loss_563)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6918/    if x.dtype not in float_type:/
  %10(CNode_564) = %9()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6918/    if x.dtype not in float_type:/
  %11(CNode_566) = call @4↓mse_loss_565(%10)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:100/        e_latent_loss = ops.mse_loss(quantized, inputs)/
  Return(%11)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6918/    if x.dtype not in float_type:/
}
# Order:
#   1: @3↓mse_loss_549:CNode_555{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.Square'}
#   2: @3↓mse_loss_549:CNode_556{[0]: CNode_555}
#   3: @3↓mse_loss_549:CNode_557{[0]: ValueNode<DoSignaturePrimitive> S_Prim_sub, [1]: param_input, [2]: param_target}
#   4: @3↓mse_loss_549:x{[0]: CNode_556, [1]: CNode_557}
#   5: @3↓mse_loss_549:float_type{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Float> Float16, [2]: ValueNode<Float> Float32, [3]: ValueNode<Float> Float64}
#   6: @3↓mse_loss_549:CNode_558{[0]: ValueNode<Primitive> getattr, [1]: x, [2]: ValueNode<StringImm> dtype}
#   7: @3↓mse_loss_549:CNode_559{[0]: ValueNode<DoSignaturePrimitive> S_Prim_not_in, [1]: CNode_558, [2]: float_type}
#   8: @3↓mse_loss_549:CNode_560{[0]: ValueNode<Primitive> Cond, [1]: CNode_559, [2]: ValueNode<BoolImm> false}
#   9: @3↓mse_loss_549:CNode_561{[0]: ValueNode<Primitive> Switch, [1]: CNode_560, [2]: ValueNode<FuncGraph> ✓3↓mse_loss_562, [3]: ValueNode<FuncGraph> ✗3↓mse_loss_563}
#  10: @3↓mse_loss_549:CNode_564{[0]: CNode_561}
#  11: @3↓mse_loss_549:CNode_566{[0]: ValueNode<FuncGraph> 4↓mse_loss_565, [1]: CNode_564}
#  12: @3↓mse_loss_549:CNode_567{[0]: ValueNode<Primitive> Return, [1]: CNode_566}


subgraph attr:
after_block : 1
subgraph instance: 4↓mse_loss_565 : 0x7081c150
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @4↓mse_loss_565 parent: [subgraph @3↓mse_loss_549](%para45_) {
  %1(CNode_568) = S_Prim_equal(%para29_reduction, "sum")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6926/    if reduction == 'sum':/
  %2(CNode_569) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6926/    if reduction == 'sum':/
  %3(CNode_570) = Switch(%2, @✓4↓mse_loss_571, @✗4↓mse_loss_572)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6926/    if reduction == 'sum':/
  %4(CNode_573) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6926/    if reduction == 'sum':/
  Return(%4)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6926/    if reduction == 'sum':/
}
# Order:
#   1: @4↓mse_loss_565:CNode_574{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.array_ops.Cast'}
#   2: @4↓mse_loss_565:CNode_575{[0]: CNode_574}
#   3: @4↓mse_loss_565:x{[0]: CNode_575, [1]: x, [2]: ValueNode<Float> Float32}
#   4: @4↓mse_loss_565:CNode_568{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: param_reduction, [2]: ValueNode<StringImm> sum}
#   5: @4↓mse_loss_565:CNode_569{[0]: ValueNode<Primitive> Cond, [1]: CNode_568, [2]: ValueNode<BoolImm> false}
#   6: @4↓mse_loss_565:CNode_570{[0]: ValueNode<Primitive> Switch, [1]: CNode_569, [2]: ValueNode<FuncGraph> ✓4↓mse_loss_571, [3]: ValueNode<FuncGraph> ✗4↓mse_loss_572}
#   7: @4↓mse_loss_565:CNode_573{[0]: CNode_570}
#   8: @4↓mse_loss_565:CNode_576{[0]: ValueNode<Primitive> Return, [1]: CNode_573}


subgraph attr:
subgraph instance: ✓3↓mse_loss_562 : 0x7081b220
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✓3↓mse_loss_562() {
  Return(F32)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6919/        input_dtype = mstype.float32/
}
# Order:
#   1: @✓3↓mse_loss_562:CNode_577{[0]: ValueNode<Primitive> Return, [1]: ValueNode<Float> Float32}


subgraph attr:
subgraph instance: ✗3↓mse_loss_563 : 0x7081b970
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✗3↓mse_loss_563 parent: [subgraph @3↓mse_loss_549]() {
  %1(CNode_555) = $(3↓mse_loss_549):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %2(CNode_556) = $(3↓mse_loss_549):%1()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %3(CNode_557) = $(3↓mse_loss_549):S_Prim_sub(%para27_input, %para28_target)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %4(x) = $(3↓mse_loss_549):%2(%3)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %5(input_dtype) = getattr(%4, "dtype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6921/        input_dtype = x.dtype/
  Return(%5)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6921/        input_dtype = x.dtype/
}
# Order:
#   1: @✗3↓mse_loss_563:input_dtype{[0]: ValueNode<Primitive> getattr, [1]: x, [2]: ValueNode<StringImm> dtype}
#   2: @✗3↓mse_loss_563:CNode_578{[0]: ValueNode<Primitive> Return, [1]: input_dtype}


subgraph attr:
subgraph instance: ✓4↓mse_loss_571 : 0x70829d70
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✓4↓mse_loss_571 parent: [subgraph @4↓mse_loss_565]() {
  %1(CNode_580) = call @5↓mse_loss_579(Bool(0))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:100/        e_latent_loss = ops.mse_loss(quantized, inputs)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6927/        average_flag = False/
}
# Order:
#   1: @✓4↓mse_loss_571:CNode_581{[0]: ValueNode<Primitive> Return, [1]: CNode_580}
#   2: @✓4↓mse_loss_571:CNode_580{[0]: ValueNode<FuncGraph> 5↓mse_loss_579, [1]: ValueNode<BoolImm> false}


subgraph attr:
subgraph instance: ✗4↓mse_loss_572 : 0x7082a550
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✗4↓mse_loss_572 parent: [subgraph @4↓mse_loss_565]() {
  %1(CNode_582) = call @5↓mse_loss_579(Bool(1))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:100/        e_latent_loss = ops.mse_loss(quantized, inputs)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6926/    if reduction == 'sum':/
}
# Order:
#   1: @✗4↓mse_loss_572:CNode_583{[0]: ValueNode<Primitive> Return, [1]: CNode_582}
#   2: @✗4↓mse_loss_572:CNode_582{[0]: ValueNode<FuncGraph> 5↓mse_loss_579, [1]: ValueNode<BoolImm> true}


subgraph attr:
after_block : 1
subgraph instance: 5↓mse_loss_579 : 0x7082ad30
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @5↓mse_loss_579 parent: [subgraph @4↓mse_loss_565](%para46_) {
  %1(CNode_584) = S_Prim_equal(%para29_reduction, "none")
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6928/    if reduction == 'none':/
  %2(CNode_585) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6928/    if reduction == 'none':/
  %3(CNode_586) = Switch(%2, @✓5↓mse_loss_587, @✗5↓mse_loss_588)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6928/    if reduction == 'none':/
  %4(CNode_589) = %3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6928/    if reduction == 'none':/
  Return(%4)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6928/    if reduction == 'none':/
}
# Order:
#   1: @5↓mse_loss_579:CNode_584{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: param_reduction, [2]: ValueNode<StringImm> none}
#   2: @5↓mse_loss_579:CNode_585{[0]: ValueNode<Primitive> Cond, [1]: CNode_584, [2]: ValueNode<BoolImm> false}
#   3: @5↓mse_loss_579:CNode_586{[0]: ValueNode<Primitive> Switch, [1]: CNode_585, [2]: ValueNode<FuncGraph> ✓5↓mse_loss_587, [3]: ValueNode<FuncGraph> ✗5↓mse_loss_588}
#   4: @5↓mse_loss_579:CNode_589{[0]: CNode_586}
#   5: @5↓mse_loss_579:CNode_590{[0]: ValueNode<Primitive> Return, [1]: CNode_589}


subgraph attr:
subgraph instance: ✓5↓mse_loss_587 : 0x70830400
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✓5↓mse_loss_587 parent: [subgraph @5↓mse_loss_579]() {
  %1(CNode_592) = call @6↓mse_loss_591(Bool(0))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:100/        e_latent_loss = ops.mse_loss(quantized, inputs)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6929/        reduce_flag = False/
}
# Order:
#   1: @✓5↓mse_loss_587:CNode_593{[0]: ValueNode<Primitive> Return, [1]: CNode_592}
#   2: @✓5↓mse_loss_587:CNode_592{[0]: ValueNode<FuncGraph> 6↓mse_loss_591, [1]: ValueNode<BoolImm> false}


subgraph attr:
subgraph instance: ✗5↓mse_loss_588 : 0x70830b50
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✗5↓mse_loss_588 parent: [subgraph @5↓mse_loss_579]() {
  %1(CNode_594) = call @6↓mse_loss_591(Bool(1))
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:100/        e_latent_loss = ops.mse_loss(quantized, inputs)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6928/    if reduction == 'none':/
}
# Order:
#   1: @✗5↓mse_loss_588:CNode_595{[0]: ValueNode<Primitive> Return, [1]: CNode_594}
#   2: @✗5↓mse_loss_588:CNode_594{[0]: ValueNode<FuncGraph> 6↓mse_loss_591, [1]: ValueNode<BoolImm> true}


subgraph attr:
after_block : 1
subgraph instance: 6↓mse_loss_591 : 0x70831330
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @6↓mse_loss_591 parent: [subgraph @5↓mse_loss_579](%para47_) {
  %1(CNode_596) = Cond(%para47_фreduce_flag, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
  %2(CNode_597) = Switch(%1, @↰6↓mse_loss_598, @↱6↓mse_loss_599)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
  %3(CNode_600) = %2()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
  %4(CNode_601) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
  %5(CNode_602) = Switch(%4, @✓6↓mse_loss_603, @✗6↓mse_loss_604)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
  %6(CNode_605) = %5()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
  %7(CNode_607) = call @7↓mse_loss_606(%6)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:100/        e_latent_loss = ops.mse_loss(quantized, inputs)/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
}
# Order:
#   1: @6↓mse_loss_591:CNode_596{[0]: ValueNode<Primitive> Cond, [1]: param_фreduce_flag, [2]: ValueNode<BoolImm> false}
#   2: @6↓mse_loss_591:CNode_597{[0]: ValueNode<Primitive> Switch, [1]: CNode_596, [2]: ValueNode<FuncGraph> ↰6↓mse_loss_598, [3]: ValueNode<FuncGraph> ↱6↓mse_loss_599}
#   3: @6↓mse_loss_591:CNode_600{[0]: CNode_597}
#   4: @6↓mse_loss_591:CNode_601{[0]: ValueNode<Primitive> Cond, [1]: CNode_600, [2]: ValueNode<BoolImm> false}
#   5: @6↓mse_loss_591:CNode_602{[0]: ValueNode<Primitive> Switch, [1]: CNode_601, [2]: ValueNode<FuncGraph> ✓6↓mse_loss_603, [3]: ValueNode<FuncGraph> ✗6↓mse_loss_604}
#   6: @6↓mse_loss_591:CNode_605{[0]: CNode_602}
#   7: @6↓mse_loss_591:CNode_607{[0]: ValueNode<FuncGraph> 7↓mse_loss_606, [1]: CNode_605}
#   8: @6↓mse_loss_591:CNode_608{[0]: ValueNode<Primitive> Return, [1]: CNode_607}


subgraph attr:
after_block : 1
subgraph instance: 7↓mse_loss_606 : 0x7083b450
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @7↓mse_loss_606 parent: [subgraph @6↓mse_loss_591](%para48_) {
  %1(CNode_609) = Cond(%para47_фreduce_flag, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
  %2(CNode_610) = Switch(%1, @↰7↓mse_loss_611, @↱7↓mse_loss_612)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
  %3(CNode_613) = %2()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
  %4(CNode_614) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
  %5(CNode_615) = Switch(%4, @✓7↓mse_loss_616, @✗7↓mse_loss_617)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
  %6(CNode_618) = %5()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
  %7(CNode_620) = call @8↓mse_loss_619(%6)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/codes/DSR_anomaly_detection-main/discrete_model.py:100/        e_latent_loss = ops.mse_loss(quantized, inputs)/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
}
# Order:
#   1: @7↓mse_loss_606:CNode_609{[0]: ValueNode<Primitive> Cond, [1]: param_фreduce_flag, [2]: ValueNode<BoolImm> false}
#   2: @7↓mse_loss_606:CNode_610{[0]: ValueNode<Primitive> Switch, [1]: CNode_609, [2]: ValueNode<FuncGraph> ↰7↓mse_loss_611, [3]: ValueNode<FuncGraph> ↱7↓mse_loss_612}
#   3: @7↓mse_loss_606:CNode_613{[0]: CNode_610}
#   4: @7↓mse_loss_606:CNode_614{[0]: ValueNode<Primitive> Cond, [1]: CNode_613, [2]: ValueNode<BoolImm> false}
#   5: @7↓mse_loss_606:CNode_615{[0]: ValueNode<Primitive> Switch, [1]: CNode_614, [2]: ValueNode<FuncGraph> ✓7↓mse_loss_616, [3]: ValueNode<FuncGraph> ✗7↓mse_loss_617}
#   6: @7↓mse_loss_606:CNode_618{[0]: CNode_615}
#   7: @7↓mse_loss_606:CNode_620{[0]: ValueNode<FuncGraph> 8↓mse_loss_619, [1]: CNode_618}
#   8: @7↓mse_loss_606:CNode_621{[0]: ValueNode<Primitive> Return, [1]: CNode_620}


subgraph attr:
subgraph instance: ✓6↓mse_loss_603 : 0x7083a490
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✓6↓mse_loss_603 parent: [subgraph @4↓mse_loss_565]() {
  %1(CNode_622) = call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6932/        x = _get_cache_prim(P.ReduceMean)()(x, _get_axis(x))/
  %2(CNode_623) = %1()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6932/        x = _get_cache_prim(P.ReduceMean)()(x, _get_axis(x))/
  %3(CNode_574) = $(4↓mse_loss_565):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6922/    x = _get_cache_prim(P.Cast)()(x, mstype.float32)/
  %4(CNode_575) = $(4↓mse_loss_565):%3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6922/    x = _get_cache_prim(P.Cast)()(x, mstype.float32)/
  %5(CNode_555) = $(3↓mse_loss_549):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %6(CNode_556) = $(3↓mse_loss_549):%5()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %7(CNode_557) = $(3↓mse_loss_549):S_Prim_sub(%para27_input, %para28_target)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %8(x) = $(3↓mse_loss_549):%6(%7)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %9(x) = $(4↓mse_loss_565):%4(%8, F32)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6922/    x = _get_cache_prim(P.Cast)()(x, mstype.float32)/
  %10(CNode_625) = call @_get_axis_624(%9)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6932/        x = _get_cache_prim(P.ReduceMean)()(x, _get_axis(x))/
  %11(x) = %2(%9, %10)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6932/        x = _get_cache_prim(P.ReduceMean)()(x, _get_axis(x))/
  Return(%11)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6932/        x = _get_cache_prim(P.ReduceMean)()(x, _get_axis(x))/
}
# Order:
#   1: @✓6↓mse_loss_603:CNode_622{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.ReduceMean'}
#   2: @✓6↓mse_loss_603:CNode_623{[0]: CNode_622}
#   3: @✓6↓mse_loss_603:CNode_625{[0]: ValueNode<FuncGraph> _get_axis_624, [1]: x}
#   4: @✓6↓mse_loss_603:x{[0]: CNode_623, [1]: x, [2]: CNode_625}
#   5: @✓6↓mse_loss_603:CNode_626{[0]: ValueNode<Primitive> Return, [1]: x}


subgraph attr:
subgraph instance: ✗6↓mse_loss_604 : 0x7083ac10
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✗6↓mse_loss_604 parent: [subgraph @4↓mse_loss_565]() {
  %1(CNode_574) = $(4↓mse_loss_565):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6922/    x = _get_cache_prim(P.Cast)()(x, mstype.float32)/
  %2(CNode_575) = $(4↓mse_loss_565):%1()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6922/    x = _get_cache_prim(P.Cast)()(x, mstype.float32)/
  %3(CNode_555) = $(3↓mse_loss_549):call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %4(CNode_556) = $(3↓mse_loss_549):%3()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %5(CNode_557) = $(3↓mse_loss_549):S_Prim_sub(%para27_input, %para28_target)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %6(x) = $(3↓mse_loss_549):%4(%5)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6916/    x = _get_cache_prim(P.Square)()(input - target)/
  %7(x) = $(4↓mse_loss_565):%2(%6, F32)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6922/    x = _get_cache_prim(P.Cast)()(x, mstype.float32)/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
}
# Order:
#   1: @✗6↓mse_loss_604:CNode_627{[0]: ValueNode<Primitive> Return, [1]: x}


subgraph attr:
subgraph instance: ↰6↓mse_loss_598 : 0x70835d10
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @↰6↓mse_loss_598 parent: [subgraph @5↓mse_loss_579]() {
  Return(%para46_фaverage_flag)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
}
# Order:
#   1: @↰6↓mse_loss_598:CNode_628{[0]: ValueNode<Primitive> Return, [1]: param_фaverage_flag}


subgraph attr:
subgraph instance: ↱6↓mse_loss_599 : 0x70836460
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @↱6↓mse_loss_599 parent: [subgraph @6↓mse_loss_591]() {
  Return(%para47_фreduce_flag)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6931/    if reduce_flag and average_flag:/
}
# Order:
#   1: @↱6↓mse_loss_599:CNode_629{[0]: ValueNode<Primitive> Return, [1]: param_фreduce_flag}


subgraph attr:
after_block : 1
subgraph instance: 8↓mse_loss_619 : 0x7084ddc0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @8↓mse_loss_619 parent: [subgraph @4↓mse_loss_565](%para49_) {
  %1(CNode_630) = call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6937/    return _get_cache_prim(P.Cast)()(x, input_dtype)/
  %2(CNode_631) = %1()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6937/    return _get_cache_prim(P.Cast)()(x, input_dtype)/
  %3(CNode_632) = %2(%para49_фx, %para45_фinput_dtype)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6937/    return _get_cache_prim(P.Cast)()(x, input_dtype)/
  Return(%3)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6937/    return _get_cache_prim(P.Cast)()(x, input_dtype)/
}
# Order:
#   1: @8↓mse_loss_619:CNode_630{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.array_ops.Cast'}
#   2: @8↓mse_loss_619:CNode_631{[0]: CNode_630}
#   3: @8↓mse_loss_619:CNode_632{[0]: CNode_631, [1]: param_фx, [2]: param_фinput_dtype}
#   4: @8↓mse_loss_619:CNode_633{[0]: ValueNode<Primitive> Return, [1]: CNode_632}


subgraph attr:
subgraph instance: ✓7↓mse_loss_616 : 0x7084cde0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✓7↓mse_loss_616 parent: [subgraph @7↓mse_loss_606]() {
  %1(CNode_634) = call @_get_cache_prim_176(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6935/        x = _get_cache_prim(P.ReduceSum)()(x, _get_axis(x))/
  %2(CNode_635) = %1()
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6935/        x = _get_cache_prim(P.ReduceSum)()(x, _get_axis(x))/
  %3(CNode_636) = call @_get_axis_624(%para48_фx)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6935/        x = _get_cache_prim(P.ReduceSum)()(x, _get_axis(x))/
  %4(x) = %2(%para48_фx, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6935/        x = _get_cache_prim(P.ReduceSum)()(x, _get_axis(x))/
  Return(%4)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6935/        x = _get_cache_prim(P.ReduceSum)()(x, _get_axis(x))/
}
# Order:
#   1: @✓7↓mse_loss_616:CNode_634{[0]: ValueNode<FuncGraph> _get_cache_prim_176, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.ReduceSum'}
#   2: @✓7↓mse_loss_616:CNode_635{[0]: CNode_634}
#   3: @✓7↓mse_loss_616:CNode_636{[0]: ValueNode<FuncGraph> _get_axis_624, [1]: param_фx}
#   4: @✓7↓mse_loss_616:x{[0]: CNode_635, [1]: param_фx, [2]: CNode_636}
#   5: @✓7↓mse_loss_616:CNode_637{[0]: ValueNode<Primitive> Return, [1]: x}


subgraph attr:
subgraph instance: ✗7↓mse_loss_617 : 0x7084d560
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @✗7↓mse_loss_617 parent: [subgraph @7↓mse_loss_606]() {
  Return(%para48_фx)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
}
# Order:
#   1: @✗7↓mse_loss_617:CNode_638{[0]: ValueNode<Primitive> Return, [1]: param_фx}


subgraph attr:
subgraph instance: ↰7↓mse_loss_611 : 0x708482a0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @↰7↓mse_loss_611 parent: [subgraph @5↓mse_loss_579]() {
  %1(CNode_639) = S_Prim_logical_not(%para46_фaverage_flag)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
}
# Order:
#   1: @↰7↓mse_loss_611:CNode_639{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: param_фaverage_flag}
#   2: @↰7↓mse_loss_611:CNode_640{[0]: ValueNode<Primitive> Return, [1]: CNode_639}


subgraph attr:
subgraph instance: ↱7↓mse_loss_612 : 0x708489f0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6869/def mse_loss(input, target, reduction='mean'):/
subgraph @↱7↓mse_loss_612 parent: [subgraph @6↓mse_loss_591]() {
  Return(%para47_фreduce_flag)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:6934/    if reduce_flag and not average_flag:/
}
# Order:
#   1: @↱7↓mse_loss_612:CNode_641{[0]: ValueNode<Primitive> Return, [1]: param_фreduce_flag}


subgraph attr:
subgraph instance: _get_axis_624 : 0x75eb2300
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:4375/def _get_axis(x):/
subgraph @_get_axis_624(%para50_x) {
  %1(shape) = call @shape_642(%para50_x)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:4377/    shape = ops.shape(x)/
  %2(length) = S_Prim_sequence_len(%1)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:4378/    length = ops.tuple_len(shape)/
  %3(perm) = S_Prim_make_range(I64(0), %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:4379/    perm = ops.make_range(0, length)/
  Return(%3)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:4380/    return perm/
}
# Order:
#   1: @_get_axis_624:shape{[0]: ValueNode<FuncGraph> shape_642, [1]: param_x}
#   2: @_get_axis_624:length{[0]: ValueNode<DoSignaturePrimitive> S_Prim_sequence_len, [1]: shape}
#   3: @_get_axis_624:perm{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_range, [1]: ValueNode<Int64Imm> 0, [2]: length}
#   4: @_get_axis_624:CNode_643{[0]: ValueNode<Primitive> Return, [1]: perm}


subgraph attr:
subgraph instance: shape_642 : 0x75eb27c0
# In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1484/def shape(input_x):/
subgraph @shape_642(%para51_input_x) {
  %1(CNode_644) = S_Prim_Shape(%para51_input_x)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1510/    return shape_(input_x)/
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yyk/miniconda3/envs/minds/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1510/    return shape_(input_x)/
}
# Order:
#   1: @shape_642:CNode_644{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: param_input_x}
#   2: @shape_642:CNode_645{[0]: ValueNode<Primitive> Return, [1]: CNode_644}


